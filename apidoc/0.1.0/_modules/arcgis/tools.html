

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>arcgis.tools &mdash; arcgis 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="arcgis 0.1 documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../index.html" class="icon icon-home"> arcgis
        

        
        </a>

        
          
          
            <div class="version">
              0.1
            </div>
          
        

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../arcgis.html">arcgis package</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">arcgis</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>arcgis.tools</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for arcgis.tools</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The arcgis.tools module is used for consuming the GIS functionality exposed from ArcGIS Online </span>
<span class="sd">or Portal web services. It has implementations for Spatial Analysis tools, GeoAnalytics tools,</span>
<span class="sd">Raster Analysis tools, Geoprocessing tools, Geocoders and Geometry Utility services. </span>
<span class="sd">These tools primarily operate on items and layers from the GIS. </span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">types</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">pandas.io.json</span> <span class="kn">import</span> <span class="n">json_normalize</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>
<span class="kn">from</span> <span class="nn">arcgis.lyr</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">urllib.parse</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">arcgis.gis</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">tempfile</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">_id_generator</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">chars</span><span class="o">=</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>

<span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">_tempinput</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s">&#39;UTF-8&#39;</span><span class="p">)))</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">yield</span> <span class="n">temp</span><span class="o">.</span><span class="n">name</span>
    <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_get_hosted_server_admin_url</span><span class="p">(</span><span class="n">servers</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="n">servers</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">server</span><span class="p">[</span><span class="s">&#39;isHosted&#39;</span><span class="p">]:</span> 
            <span class="k">return</span> <span class="n">server</span><span class="p">[</span><span class="s">&#39;adminUrl&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;/admin&#39;</span>
    <span class="k">return</span> <span class="bp">None</span>

<div class="viewcode-block" id="Geocoder"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.Geocoder">[docs]</a><span class="k">class</span> <span class="nc">Geocoder</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="s">&quot;represents a geocode (locator) service&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">gis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a Geocoder object given a geocoding service item from ArcGIS Online or Portal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">gis</span><span class="o">.</span><span class="n">_portal</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&#39;geocoding service&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;item type must be geocoding service&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">_portal</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">url</span>
        
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>
        <span class="n">svcprops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">use_ordered_dict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">svcprops</span><span class="p">)</span>



    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># return &quot;Geocode service at &quot; + self.url</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Geocoder.reverse_geocode"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.Geocoder.reverse_geocode">[docs]</a>    <span class="k">def</span> <span class="nf">reverse_geocode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The reverseGeocode operation determines the address at a particular</span>
<span class="sd">        x/y location. You pass the coordinates of a point location to the</span>
<span class="sd">        geocoding service, and the service returns the address that is</span>
<span class="sd">        closest to the location.</span>
<span class="sd">        Input:</span>
<span class="sd">           location - a list defined as [X,Y]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/reverseGeocode&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Invalid location&quot;</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>
    </div>
<div class="viewcode-block" id="Geocoder.geocode_addresses"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.Geocoder.geocode_addresses">[docs]</a>    <span class="k">def</span> <span class="nf">geocode_addresses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                         <span class="n">addresses</span><span class="p">,</span>
                         <span class="n">outSR</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                         <span class="n">sourceCountry</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                         <span class="n">category</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The geocodeAddresses operation is performed on a Geocode Service</span>
<span class="sd">        resource. The result of this operation is a resource representing</span>
<span class="sd">        the list of geocoded addresses. This resource provides information</span>
<span class="sd">        about the addresses including the address, location, score, and</span>
<span class="sd">        other geocode service-specific attributes.You can provide arguments</span>
<span class="sd">        to the geocodeAddresses operation as query parameters defined in</span>
<span class="sd">        the following parameters table.</span>

<span class="sd">        See https://developers.arcgis.com/rest/geocode/api-reference/geocoding-geocode-addresses.htm</span>

<span class="sd">        Inputs:</span>
<span class="sd">           addresses - A record set representing the addresses to be</span>
<span class="sd">            geocoded. Each record must include an OBJECTID attribute with a</span>
<span class="sd">            unique value, as well as various address fields accepted by the</span>
<span class="sd">            corresponding geocode service. The field names that should be</span>
<span class="sd">            used can be found in the JSON representation of the geocode</span>
<span class="sd">            service resource under the addressFields property, for multiple</span>
<span class="sd">            input field geocoding, or the singleLineAddressField property,</span>
<span class="sd">            for single input field geocoding. The OBJECTID specified in the</span>
<span class="sd">            request is reflected as ResultID in the response.</span>
<span class="sd">            The maximum number of addresses that can be geocoded in a</span>
<span class="sd">            single request is limited to the SuggestedBatchSize property of</span>
<span class="sd">            the locator.</span>
<span class="sd">            Syntax:</span>
<span class="sd">             {</span>
<span class="sd">                &quot;records&quot;  : [</span>
<span class="sd">                {</span>
<span class="sd">                   &quot;attributes&quot; : {&quot;&lt;OBJECTID&gt;&quot; : &quot;&lt;OID11&gt;&quot;,</span>
<span class="sd">                                   &quot;&lt;field1&gt;&quot; : &quot;&lt;value11&gt;&quot;,</span>
<span class="sd">                                   &quot;&lt;field2&gt;&quot; : &quot;&lt;value12&gt;&quot;,</span>
<span class="sd">                                   &quot;&lt;field3&gt;&quot; : &quot;&lt;value13&gt;&quot;</span>
<span class="sd">                                   }</span>
<span class="sd">                },</span>
<span class="sd">                {</span>
<span class="sd">                   &quot;attributes&quot; : {&quot;&lt;OBJECTID&gt;&quot; : &quot;&lt;OID12&gt;&quot;,</span>
<span class="sd">                                   &quot;&lt;field1&gt;&quot; : &quot;&lt;value11&gt;&quot;,</span>
<span class="sd">                                   &quot;&lt;field2&gt;&quot; : &quot;&lt;value12&gt;&quot;,</span>
<span class="sd">                                   &quot;&lt;field3&gt;&quot; : &quot;&lt;value13&gt;&quot;</span>
<span class="sd">                                   }</span>
<span class="sd">                }</span>
<span class="sd">                ]</span>
<span class="sd">             }</span>
<span class="sd">           outSR - The well-known ID of the spatial reference, or a spatial</span>
<span class="sd">            reference json object for the returned addresses. For a list of</span>
<span class="sd">            valid WKID values, see Projected coordinate systems and</span>
<span class="sd">            Geographic coordinate systems.</span>
<span class="sd">           sourceCountry - The sourceCountry parameter is only supported by</span>
<span class="sd">            geocode services published using StreetMap Premium locators.</span>
<span class="sd">            Added at 10.3 and only supported by geocode services published</span>
<span class="sd">            with ArcGIS 10.3 for Server and later versions.</span>
<span class="sd">           category - The category parameter is only supported by geocode</span>
<span class="sd">            services published using StreetMap Premium locators.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/geocodeAddresses&quot;</span>
        <span class="k">if</span> <span class="n">outSR</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;outSR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outSR</span>
        <span class="k">if</span> <span class="n">sourceCountry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;sourceCountry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sourceCountry</span>
        <span class="k">if</span> <span class="n">category</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&#39;addresses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">addresses</span>
        
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>
    </div>
<div class="viewcode-block" id="Geocoder.find"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.Geocoder.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">text</span><span class="p">,</span>
             <span class="n">magicKey</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">sourceCountry</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">outSR</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">category</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">outFields</span><span class="o">=</span><span class="s">&quot;*&quot;</span><span class="p">,</span>
             <span class="n">maxLocations</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
             <span class="n">forStorage</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The find operation geocodes one location per request; the input</span>
<span class="sd">        address is specified in a single parameter. This operation is</span>
<span class="sd">        only supported with the ArcGIS World Geocoding Service.</span>

<span class="sd">        Inputs:</span>
<span class="sd">           text - Specifies the location to be geocoded. This can be a</span>
<span class="sd">            street address, place name, postal code, or POI.</span>
<span class="sd">           magicKey - The find operation retrieves results quicker when you</span>
<span class="sd">            pass in valid text and magicKey values than when you don&#39;t pass</span>
<span class="sd">            in magicKey. However, to get these advantages, you need to make</span>
<span class="sd">            a prior request to suggest, which provides a magicKey. This may</span>
<span class="sd">            or may not be relevant to your workflow.</span>
<span class="sd">           sourceCountry - A value representing the country. Providing this</span>
<span class="sd">            value increases geocoding speed. Acceptable values include the</span>
<span class="sd">            full country name in English or the official language of the</span>
<span class="sd">            country, the ISO 3166-1 2-digit country code, or the</span>
<span class="sd">            ISO 3166-1 3-digit country code.</span>
<span class="sd">           bbox - A set of bounding box coordinates that limit the search</span>
<span class="sd">            area to a specific region. This is especially useful for</span>
<span class="sd">            applications in which a user will search for places and</span>
<span class="sd">            addresses only within the current map extent.</span>
<span class="sd">           location - Defines an origin point location that is used with</span>
<span class="sd">            the distance parameter to sort geocoding candidates based upon</span>
<span class="sd">            their proximity to the location. The distance parameter</span>
<span class="sd">            specifies the radial distance from the location in meters. The</span>
<span class="sd">            priority of candidates within this radius is boosted relative</span>
<span class="sd">            to those outside the radius.</span>
<span class="sd">           distance - Specifies the radius of an area around a point</span>
<span class="sd">            location which is used to boost the rank of geocoding</span>
<span class="sd">            candidates so that candidates closest to the location are</span>
<span class="sd">            returned first. The distance value is in meters.</span>
<span class="sd">           outSR - The spatial reference of the x/y coordinates returned by</span>
<span class="sd">            a geocode request. This is useful for applications using a map</span>
<span class="sd">            with a spatial reference different than that of the geocode</span>
<span class="sd">            service.</span>
<span class="sd">           category - A place or address type which can be used to filter</span>
<span class="sd">            find results. The parameter supports input of single category</span>
<span class="sd">            values or multiple comma-separated values. The category</span>
<span class="sd">            parameter can be passed in a request with or without the text</span>
<span class="sd">            parameter.</span>
<span class="sd">           outFields - The list of fields to be returned in the response.</span>
<span class="sd">           maxLocation - The maximum number of locations to be returned by</span>
<span class="sd">            a search, up to the maximum number allowed by the service. If</span>
<span class="sd">            not specified, then one location will be returned.</span>
<span class="sd">           forStorage - Specifies whether the results of the operation will</span>
<span class="sd">            be persisted. The default value is false, which indicates the</span>
<span class="sd">            results of the operation can&#39;t be stored, but they can be</span>
<span class="sd">            temporarily displayed on a map for instance. If you store the</span>
<span class="sd">            results, in a database for example, you need to set this</span>
<span class="sd">            parameter to true.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#self.url + </span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/find&quot;</span> <span class="c"># &quot;http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/find&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">magicKey</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;magicKey&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">magicKey</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sourceCountry</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;sourceCountry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sourceCountry</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bbox</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;bbox&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bbox</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">location</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> \
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="n">asDictionary</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">location</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> \
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">distance</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;distance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">outSR</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;outSR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outSR</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">category</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="k">if</span> <span class="n">outFields</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;outFields&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;*&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;outFields&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outFields</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">maxLocations</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;maxLocations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxLocations</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">forStorage</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;forStorage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">forStorage</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span><span class="p">[</span><span class="s">&#39;locations&#39;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Geocoder.find_best_match"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.Geocoder.find_best_match">[docs]</a>    <span class="k">def</span> <span class="nf">find_best_match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">text</span><span class="p">,</span>
             <span class="n">magicKey</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">sourceCountry</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">location</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">outSR</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">category</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">outFields</span><span class="o">=</span><span class="s">&quot;*&quot;</span><span class="p">,</span>
             <span class="n">forStorage</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">magicKey</span><span class="p">,</span> <span class="n">sourceCountry</span><span class="p">,</span> <span class="n">bbox</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> 
                         <span class="n">outSR</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">outFields</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> 
                         <span class="n">forStorage</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;feature&#39;</span><span class="p">][</span><span class="s">&#39;geometry&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">location</span><span class="p">[</span><span class="s">&#39;y&#39;</span><span class="p">],</span> <span class="n">location</span><span class="p">[</span><span class="s">&#39;x&#39;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Geocoder.suggest"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.Geocoder.suggest">[docs]</a>    <span class="k">def</span> <span class="nf">suggest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">text</span><span class="p">,</span>
                <span class="n">location</span><span class="p">,</span>
                <span class="n">distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">category</span><span class="o">=</span><span class="bp">None</span>
                <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The suggest operation is performed on a geocode service resource.</span>
<span class="sd">        The result of this operation is a resource representing a list of</span>
<span class="sd">        suggested matches for the input text. This resource provides the</span>
<span class="sd">        matching text as well as a unique ID value, which links a</span>
<span class="sd">        suggestion to a specific place or address.</span>
<span class="sd">        A geocode service must meet the following requirements to support</span>
<span class="sd">        the suggest operation:</span>
<span class="sd">          The address locator from which the geocode service was published</span>
<span class="sd">          must support suggestions. Only address locators created using</span>
<span class="sd">          ArcGIS 10.3 for Desktop and later can support suggestions. See</span>
<span class="sd">          the Create Address Locator geoprocessing tool help topic for more</span>
<span class="sd">          information.</span>
<span class="sd">          The geocode service must have the Suggest capability enabled.</span>
<span class="sd">          Only geocode services published using ArcGIS 10.3 for Server or</span>
<span class="sd">          later support the Suggest capability.</span>
<span class="sd">        The suggest operation allows character-by-character auto-complete</span>
<span class="sd">        suggestions to be generated for user input in a client application.</span>
<span class="sd">        This capability facilitates the interactive search user experience</span>
<span class="sd">        by reducing the number of characters that need to be typed before</span>
<span class="sd">        a suggested match is obtained. A client application can provide a</span>
<span class="sd">        list of suggestions that is updated with each character typed by a</span>
<span class="sd">        user until the address they are looking for appears in the list.</span>
<span class="sd">        Inputs:</span>
<span class="sd">           text - The input text provided by a user that is used by the</span>
<span class="sd">            suggest operation to generate a list of possible matches. This</span>
<span class="sd">            is a required parameter.</span>
<span class="sd">           location -  Defines an origin point location that is used with</span>
<span class="sd">            the distance parameter to sort suggested candidates based on</span>
<span class="sd">            their proximity to the location. The distance parameter</span>
<span class="sd">            specifies the radial distance from the location in meters. The</span>
<span class="sd">            priority of candidates within this radius is boosted relative</span>
<span class="sd">            to those outside the radius.</span>
<span class="sd">            This is useful in mobile applications where a user wants to</span>
<span class="sd">            search for places in the vicinity of their current GPS</span>
<span class="sd">            location. It is also useful for web mapping applications where</span>
<span class="sd">            a user wants to find places within or near the map extent.</span>
<span class="sd">            The location parameter can be specified without specifying a</span>
<span class="sd">            distance. If distance is not specified, it defaults to 2000</span>
<span class="sd">            meters.</span>
<span class="sd">            The object can be an common.geometry.Point or X/Y list object</span>
<span class="sd">           distance - Specifies the radius around the point defined in the</span>
<span class="sd">            location parameter to create an area, which is used to boost</span>
<span class="sd">            the rank of suggested candidates so that candidates closest to</span>
<span class="sd">            the location are returned first. The distance value is in</span>
<span class="sd">            meters.</span>
<span class="sd">            If the distance parameter is specified, the location parameter</span>
<span class="sd">            must be specified as well.</span>
<span class="sd">            It is important to note that the location and distance</span>
<span class="sd">            parameters allow searches to extend beyond the specified search</span>
<span class="sd">            radius. They are not used to filter results, but rather to rank</span>
<span class="sd">            resulting candidates based on their distance from a location.</span>
<span class="sd">           category - The category parameter is only supported by geocode</span>
<span class="sd">            services published using StreetMap Premium locators.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
            <span class="s">&quot;text&quot;</span> <span class="p">:</span> <span class="n">text</span>
        <span class="p">}</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/suggest&quot;</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Invalid location, please try again&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">category</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">distance</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">and</span> \
           <span class="nb">isinstance</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;distance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>
</div></div>
<div class="viewcode-block" id="Geometry"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.Geometry">[docs]</a><span class="k">class</span> <span class="nc">Geometry</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="s">&quot;represents a geometry service&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">gis</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a Geometry Server object given it&#39;s item from ArcGIS Online or Portal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">gis</span><span class="o">.</span><span class="n">_portal</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&#39;geometry service&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;item type must be geometry service&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">_portal</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">url</span>
        
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>
        <span class="n">svcprops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">use_ordered_dict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">svcprops</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="Geometry.areasAndLengths"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.Geometry.areasAndLengths">[docs]</a>    <span class="k">def</span> <span class="nf">areasAndLengths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">polygons</span><span class="p">,</span>
                        <span class="n">lengthUnit</span><span class="p">,</span>
                        <span class="n">areaUnit</span><span class="p">,</span>
                        <span class="n">calculationType</span><span class="p">,</span>
                        <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           The areasAndLengths operation calculates areas and perimeter lengths</span>
<span class="sd">           for each polygon specified in the input array.</span>

<span class="sd">           Inputs:</span>
<span class="sd">              polygons - The array of polygons whose areas and lengths are</span>
<span class="sd">                         to be computed.</span>
<span class="sd">              lengthUnit - The length unit in which the perimeters of</span>
<span class="sd">                           polygons will be calculated. If calculationType</span>
<span class="sd">                           is planar, then lengthUnit can be any esriUnits</span>
<span class="sd">                           constant. If lengthUnit is not specified, the</span>
<span class="sd">                           units are derived from sr. If calculationType is</span>
<span class="sd">                           not planar, then lengthUnit must be a linear</span>
<span class="sd">                           esriUnits constant, such as esriSRUnit_Meter or</span>
<span class="sd">                           esriSRUnit_SurveyMile. If lengthUnit is not</span>
<span class="sd">                           specified, the units are meters. For a list of</span>
<span class="sd">                           valid units, see esriSRUnitType Constants and</span>
<span class="sd">                           esriSRUnit2Type Constant.</span>
<span class="sd">              areaUnit - The area unit in which areas of polygons will be</span>
<span class="sd">                         calculated. If calculationType is planar, then</span>
<span class="sd">                         areaUnit can be any esriUnits constant. If</span>
<span class="sd">                         areaUnit is not specified, the units are derived</span>
<span class="sd">                         from sr. If calculationType is not planar, then</span>
<span class="sd">                         areaUnit must be a linear esriUnits constant such</span>
<span class="sd">                         as esriSRUnit_Meter or esriSRUnit_SurveyMile. If</span>
<span class="sd">                         areaUnit is not specified, then the units are</span>
<span class="sd">                         meters. For a list of valid units, see</span>
<span class="sd">                         esriSRUnitType Constants and esriSRUnit2Type</span>
<span class="sd">                         constant.</span>
<span class="sd">                         The list of valid esriAreaUnits constants include,</span>
<span class="sd">                         esriSquareInches | esriSquareFeet |</span>
<span class="sd">                         esriSquareYards | esriAcres | esriSquareMiles |</span>
<span class="sd">                         esriSquareMillimeters | esriSquareCentimeters |</span>
<span class="sd">                         esriSquareDecimeters | esriSquareMeters | esriAres</span>
<span class="sd">                         | esriHectares | esriSquareKilometers.</span>
<span class="sd">              calculationType -  The type defined for the area and length</span>
<span class="sd">                                 calculation of the input geometries. The</span>
<span class="sd">                                 type can be one of the following values:</span>
<span class="sd">                                 planar - Planar measurements use 2D</span>
<span class="sd">                                          Euclidean distance to calculate</span>
<span class="sd">                                          area and length. This should</span>
<span class="sd">                                          only be used if the area or</span>
<span class="sd">                                          length needs to be calculated in</span>
<span class="sd">                                          the given spatial reference.</span>
<span class="sd">                                          Otherwise, use preserveShape.</span>
<span class="sd">                                 geodesic - Use this type if you want to</span>
<span class="sd">                                          calculate an area or length using</span>
<span class="sd">                                          only the vertices of the polygon</span>
<span class="sd">                                          and define the lines between the</span>
<span class="sd">                                          points as geodesic segments</span>
<span class="sd">                                          independent of the actual shape</span>
<span class="sd">                                          of the polygon. A geodesic</span>
<span class="sd">                                          segment is the shortest path</span>
<span class="sd">                                          between two points on an ellipsoid.</span>
<span class="sd">                                 preserveShape - This type calculates the</span>
<span class="sd">                                          area or length of the geometry on</span>
<span class="sd">                                          the surface of the Earth</span>
<span class="sd">                                          ellipsoid. The shape of the</span>
<span class="sd">                                          geometry in its coordinate system</span>
<span class="sd">                                          is preserved.</span>
<span class="sd">           Output:</span>
<span class="sd">              JSON as dictionary</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/areasAndLengths&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
            <span class="s">&quot;lengthUnit&quot;</span> <span class="p">:</span> <span class="n">lengthUnit</span><span class="p">,</span>
            <span class="s">&quot;areaUnit&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s">&quot;areaUnit&quot;</span> <span class="p">:</span> <span class="n">areaUnit</span><span class="p">},</span>
            <span class="s">&quot;calculationType&quot;</span> <span class="p">:</span> <span class="n">calculationType</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">polygons</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">polygons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">polygons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">):</span>
                <span class="n">params</span><span class="p">[</span><span class="s">&#39;sr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">spatialReference</span><span class="p">[</span><span class="s">&#39;wkid&#39;</span><span class="p">]</span>
                <span class="n">params</span><span class="p">[</span><span class="s">&#39;polygons&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">poly</span><span class="o">.</span><span class="n">asDictionary</span> <span class="k">for</span> <span class="n">poly</span> <span class="ow">in</span> <span class="n">polygons</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">p</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;No polygons provided, please submit a list of polygon geometries&quot;</span>
        
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">resp</span>
</div>
<div class="viewcode-block" id="Geometry.simplify"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.Geometry.simplify">[docs]</a>    <span class="k">def</span> <span class="nf">simplify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">sr</span><span class="p">,</span>
                 <span class="n">geometries</span>
                 <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns a simplied geometry object&quot;&quot;&quot;</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/simplify&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
            <span class="s">&quot;sr&quot;</span> <span class="p">:</span> <span class="n">sr</span><span class="p">,</span>
            <span class="s">&quot;geometries&quot;</span> <span class="p">:</span> <span class="n">geometries</span>
        <span class="p">}</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">resp</span>
    </div>
<div class="viewcode-block" id="Geometry.lengths"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.Geometry.lengths">[docs]</a>    <span class="k">def</span> <span class="nf">lengths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                <span class="n">sr</span><span class="p">,</span>
                <span class="n">polylines</span><span class="p">,</span>
                <span class="n">lengthUnit</span><span class="p">,</span>
                <span class="n">calculationType</span>
                <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
        <span class="n">allowedCalcTypes</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;planar&#39;</span><span class="p">,</span> <span class="s">&#39;geodesic&#39;</span><span class="p">,</span> <span class="s">&#39;preserveShape&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">calculationType</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowedCalcTypes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s">&quot;Invalid calculation Type&quot;</span><span class="p">)</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/lengths&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
            <span class="s">&quot;sr&quot;</span> <span class="p">:</span> <span class="n">sr</span><span class="p">,</span>
            <span class="s">&quot;polylines&quot;</span><span class="p">:</span> <span class="n">polylines</span><span class="p">,</span>
            <span class="s">&quot;lengthUnit&quot;</span> <span class="p">:</span> <span class="n">lengthUnit</span><span class="p">,</span>
            <span class="s">&quot;calculationType&quot;</span> <span class="p">:</span> <span class="n">calculationType</span>
        <span class="p">}</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">resp</span><span class="p">[</span><span class="s">&#39;lengths&#39;</span><span class="p">]</span>
</div></div>
<span class="k">class</span> <span class="nc">_AsyncService</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">gis</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="n">url</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span> <span class="o">=</span> <span class="n">gis</span><span class="o">.</span><span class="n">_portal</span>

    <span class="k">def</span> <span class="nf">_analysis_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Submits an Analysis job and returns the job URL for monitoring the job</span>
<span class="sd">            status in addition to the json response data for the submitted job.&quot;&quot;&quot;</span>
    
        <span class="c"># Unpack the Analysis job parameters as a dictionary and add token and</span>
        <span class="c"># formatting parameters to the dictionary. The dictionary is used in the</span>
        <span class="c"># HTTP POST request. Headers are also added as a dictionary to be included</span>
        <span class="c"># with the POST.</span>
        <span class="c">#</span>
        <span class="c">#print(&quot;Submitting analysis job...&quot;)</span>
        
        <span class="n">task_url</span> <span class="o">=</span> <span class="s">&quot;{}/{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">task</span><span class="p">)</span>
        <span class="n">submit_url</span> <span class="o">=</span> <span class="s">&quot;{}/submitJob&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_url</span><span class="p">)</span>
        
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;f&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;json&quot;</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">submit_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="c">#print(resp)</span>
        <span class="k">return</span> <span class="n">task_url</span><span class="p">,</span> <span class="n">resp</span>

    <span class="k">def</span> <span class="nf">_analysis_job_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Tracks the status of the submitted Analysis job.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s">&quot;jobId&quot;</span> <span class="ow">in</span> <span class="n">job_info</span><span class="p">:</span>
            <span class="c"># Get the id of the Analysis job to track the status.</span>
            <span class="c">#</span>
            <span class="n">job_id</span> <span class="o">=</span> <span class="n">job_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;jobId&quot;</span><span class="p">)</span>
            <span class="n">job_url</span> <span class="o">=</span> <span class="s">&quot;{}/jobs/{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_id</span><span class="p">)</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span> <span class="p">}</span>
            <span class="n">job_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">job_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

            <span class="c"># Query and report the Analysis job status.</span>
            <span class="c">#</span>
            <span class="n">num_messages</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="s">&quot;jobStatus&quot;</span> <span class="ow">in</span> <span class="n">job_response</span><span class="p">:</span>
                <span class="k">while</span> <span class="ow">not</span> <span class="n">job_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;jobStatus&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;esriJobSucceeded&quot;</span><span class="p">:</span>
                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            
                    <span class="n">job_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">job_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
                    <span class="c">#print(job_response)</span>
                    <span class="n">messages</span> <span class="o">=</span> <span class="n">job_response</span><span class="p">[</span><span class="s">&#39;messages&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="s">&#39;messages&#39;</span> <span class="ow">in</span> <span class="n">job_response</span> <span class="k">else</span> <span class="p">[]</span>
                    <span class="n">num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">messages</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">num</span> <span class="o">&gt;</span> <span class="n">num_messages</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_messages</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
                            <span class="n">msg</span> <span class="o">=</span> <span class="n">messages</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">msg</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;esriJobMessageTypeInformative&#39;</span><span class="p">:</span>
                                <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="s">&#39;description&#39;</span><span class="p">])</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">print</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="s">&#39;description&#39;</span><span class="p">],</span><span class="nb">file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
                        <span class="n">num_messages</span> <span class="o">=</span> <span class="n">num</span>

                    <span class="k">if</span> <span class="n">job_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;jobStatus&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;esriJobFailed&quot;</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Job failed.&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">job_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;jobStatus&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;esriJobCancelled&quot;</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Job cancelled.&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">job_response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;jobStatus&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;esriJobTimedOut&quot;</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Job timed out.&quot;</span><span class="p">)</span>
                
                <span class="k">if</span> <span class="s">&quot;results&quot;</span> <span class="ow">in</span> <span class="n">job_response</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">job_response</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;No job results.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;No job url.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_analysis_job_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Use the job result json to get information about the feature service</span>
<span class="sd">            created from the Analysis job.&quot;&quot;&quot;</span>

        <span class="c"># Get the paramUrl to get information about the Analysis job results.</span>
        <span class="c">#</span>
        <span class="k">if</span> <span class="s">&quot;jobId&quot;</span> <span class="ow">in</span> <span class="n">job_info</span><span class="p">:</span>
            <span class="n">job_id</span> <span class="o">=</span> <span class="n">job_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;jobId&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s">&quot;results&quot;</span> <span class="ow">in</span> <span class="n">job_info</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">=</span> <span class="n">job_info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;results&quot;</span><span class="p">)</span>
                <span class="n">result_values</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                    <span class="n">param_value</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s">&quot;paramUrl&quot;</span> <span class="ow">in</span> <span class="n">param_value</span><span class="p">:</span>
                        <span class="n">param_url</span> <span class="o">=</span> <span class="n">param_value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;paramUrl&quot;</span><span class="p">)</span>
                        <span class="n">result_url</span> <span class="o">=</span> <span class="s">&quot;{}/jobs/{}/{}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> 
                                                                            <span class="n">job_id</span><span class="p">,</span> 
                                                                            <span class="n">param_url</span><span class="p">)</span>

                        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span> <span class="p">}</span>
                        <span class="n">param_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">result_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

                        <span class="n">job_value</span> <span class="o">=</span> <span class="n">param_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">)</span>
                        <span class="n">result_values</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">job_value</span>
                <span class="k">return</span> <span class="n">result_values</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Unable to get analysis job results.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Unable to get analysis job results.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_feature_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_layer</span><span class="p">):</span>

        <span class="n">point_fs</span> <span class="o">=</span> <span class="p">{</span>  
           <span class="s">&quot;layerDefinition&quot;</span><span class="p">:{</span>  
              <span class="s">&quot;currentVersion&quot;</span><span class="p">:</span><span class="mf">10.11</span><span class="p">,</span>
              <span class="s">&quot;copyrightText&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span><span class="p">,</span>
              <span class="s">&quot;defaultVisibility&quot;</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span>
              <span class="s">&quot;relationships&quot;</span><span class="p">:[</span>  

              <span class="p">],</span>
              <span class="s">&quot;isDataVersioned&quot;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span>
              <span class="s">&quot;supportsRollbackOnFailureParameter&quot;</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span>
              <span class="s">&quot;supportsStatistics&quot;</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span>
              <span class="s">&quot;supportsAdvancedQueries&quot;</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span>
              <span class="s">&quot;geometryType&quot;</span><span class="p">:</span><span class="s">&quot;esriGeometryPoint&quot;</span><span class="p">,</span>
              <span class="s">&quot;minScale&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
              <span class="s">&quot;maxScale&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
              <span class="s">&quot;objectIdField&quot;</span><span class="p">:</span><span class="s">&quot;OBJECTID&quot;</span><span class="p">,</span>
              <span class="s">&quot;templates&quot;</span><span class="p">:[</span>  

              <span class="p">],</span>
              <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;Feature Layer&quot;</span><span class="p">,</span>
              <span class="s">&quot;displayField&quot;</span><span class="p">:</span><span class="s">&quot;TITLE&quot;</span><span class="p">,</span>
              <span class="s">&quot;visibilityField&quot;</span><span class="p">:</span><span class="s">&quot;VISIBLE&quot;</span><span class="p">,</span>
              <span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;startDrawPoint&quot;</span><span class="p">,</span>
              <span class="s">&quot;hasAttachments&quot;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span>
              <span class="s">&quot;typeIdField&quot;</span><span class="p">:</span><span class="s">&quot;TYPEID&quot;</span><span class="p">,</span>
              <span class="s">&quot;capabilities&quot;</span><span class="p">:</span><span class="s">&quot;Query&quot;</span><span class="p">,</span>
              <span class="s">&quot;allowGeometryUpdates&quot;</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span>
              <span class="s">&quot;htmlPopupType&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span><span class="p">,</span>
              <span class="s">&quot;hasM&quot;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span>
              <span class="s">&quot;hasZ&quot;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span>
              <span class="s">&quot;globalIdField&quot;</span><span class="p">:</span><span class="s">&quot;&quot;</span><span class="p">,</span>
              <span class="s">&quot;supportedQueryFormats&quot;</span><span class="p">:</span><span class="s">&quot;JSON&quot;</span><span class="p">,</span>
              <span class="s">&quot;hasStaticData&quot;</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span>
              <span class="s">&quot;maxRecordCount&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
              <span class="s">&quot;indexes&quot;</span><span class="p">:[</span>  

              <span class="p">],</span>
              <span class="s">&quot;types&quot;</span><span class="p">:[</span>  

              <span class="p">],</span>
              <span class="s">&quot;fields&quot;</span><span class="p">:[</span>  
                 <span class="p">{</span>  
                    <span class="s">&quot;alias&quot;</span><span class="p">:</span><span class="s">&quot;OBJECTID&quot;</span><span class="p">,</span>
                    <span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;OBJECTID&quot;</span><span class="p">,</span>
                    <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;esriFieldTypeOID&quot;</span><span class="p">,</span>
                    <span class="s">&quot;editable&quot;</span><span class="p">:</span><span class="bp">False</span>
                 <span class="p">},</span>
                 <span class="p">{</span>  
                    <span class="s">&quot;alias&quot;</span><span class="p">:</span><span class="s">&quot;Title&quot;</span><span class="p">,</span>
                    <span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;TITLE&quot;</span><span class="p">,</span>
                    <span class="s">&quot;length&quot;</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span>
                    <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;esriFieldTypeString&quot;</span><span class="p">,</span>
                    <span class="s">&quot;editable&quot;</span><span class="p">:</span><span class="bp">True</span>
                 <span class="p">},</span>
                 <span class="p">{</span>  
                    <span class="s">&quot;alias&quot;</span><span class="p">:</span><span class="s">&quot;Visible&quot;</span><span class="p">,</span>
                    <span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;VISIBLE&quot;</span><span class="p">,</span>
                    <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;esriFieldTypeInteger&quot;</span><span class="p">,</span>
                    <span class="s">&quot;editable&quot;</span><span class="p">:</span><span class="bp">True</span>
                 <span class="p">},</span>
                 <span class="p">{</span>  
                    <span class="s">&quot;alias&quot;</span><span class="p">:</span><span class="s">&quot;Description&quot;</span><span class="p">,</span>
                    <span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;DESCRIPTION&quot;</span><span class="p">,</span>
                    <span class="s">&quot;length&quot;</span><span class="p">:</span><span class="mi">1073741822</span><span class="p">,</span>
                    <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;esriFieldTypeString&quot;</span><span class="p">,</span>
                    <span class="s">&quot;editable&quot;</span><span class="p">:</span><span class="bp">True</span>
                 <span class="p">},</span>
                 <span class="p">{</span>  
                    <span class="s">&quot;alias&quot;</span><span class="p">:</span><span class="s">&quot;Type ID&quot;</span><span class="p">,</span>
                    <span class="s">&quot;name&quot;</span><span class="p">:</span><span class="s">&quot;TYPEID&quot;</span><span class="p">,</span>
                    <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;esriFieldTypeInteger&quot;</span><span class="p">,</span>
                    <span class="s">&quot;editable&quot;</span><span class="p">:</span><span class="bp">True</span>
                 <span class="p">}</span>
              <span class="p">]</span>
           <span class="p">},</span>
           <span class="s">&quot;featureSet&quot;</span><span class="p">:{</span>  
              <span class="s">&quot;features&quot;</span><span class="p">:[</span>  
                 <span class="p">{</span>  
                    <span class="s">&quot;geometry&quot;</span><span class="p">:{</span>  
                       <span class="s">&quot;x&quot;</span><span class="p">:</span><span class="mf">80.27032792000051</span><span class="p">,</span>
                       <span class="s">&quot;y&quot;</span><span class="p">:</span><span class="mf">13.085227147000467</span><span class="p">,</span>
                       <span class="s">&quot;spatialReference&quot;</span><span class="p">:{</span>  
                          <span class="s">&quot;wkid&quot;</span><span class="p">:</span> <span class="mi">4326</span><span class="p">,</span>
                          <span class="s">&quot;latestWkid&quot;</span><span class="p">:</span><span class="mi">4326</span>
                       <span class="p">}</span>
                    <span class="p">},</span>
                  <span class="s">&quot;attributes&quot;</span><span class="p">:{</span>  
                       <span class="s">&quot;description&quot;</span><span class="p">:</span><span class="s">&quot;blayer desc&quot;</span><span class="p">,</span>
                       <span class="s">&quot;title&quot;</span><span class="p">:</span><span class="s">&quot;blayer&quot;</span><span class="p">,</span>
                       <span class="s">&quot;OBJECTID&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                       <span class="s">&quot;VISIBLE&quot;</span><span class="p">:</span><span class="mi">1</span>
                    <span class="p">},</span>
                    <span class="s">&quot;symbol&quot;</span><span class="p">:{</span>  
                       <span class="s">&quot;angle&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                       <span class="s">&quot;xoffset&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                       <span class="s">&quot;yoffset&quot;</span><span class="p">:</span><span class="mf">8.15625</span><span class="p">,</span>
                       <span class="s">&quot;type&quot;</span><span class="p">:</span><span class="s">&quot;esriPMS&quot;</span><span class="p">,</span>
                       <span class="s">&quot;url&quot;</span><span class="p">:</span><span class="s">&quot;https://cdn.arcgis.com/cdn/7674/js/jsapi/esri/dijit/images/Directions/greenPoint.png&quot;</span><span class="p">,</span>
                       <span class="s">&quot;imageData&quot;</span><span class="p">:</span><span class="s">&quot;iVBORw0KGgoAAAANSUhEUgAAABUAAAAdCAYAAABFRCf7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4OTI1MkU2ODE0QzUxMUUyQURFMUNDNThGMTA3MjkzMSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4OTI1MkU2OTE0QzUxMUUyQURFMUNDNThGMTA3MjkzMSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjg5MjUyRTY2MTRDNTExRTJBREUxQ0M1OEYxMDcyOTMxIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjg5MjUyRTY3MTRDNTExRTJBREUxQ0M1OEYxMDcyOTMxIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+iVNkdQAABJlJREFUeNp0VltvG0UUnpkdr72261CnCQWEIA9FqOKlqooARUKCtAUhoA+VoBVRhfgFXKSKJ97goRL8ARCIclGgL0VUkBBAoBaVoggEQQVSAhFS06SJje3Y3t25cc7srL3YjddHs3N85pvvfOfMyJRs83n8o+P7POI9yQibooTeBa68ISbSRv+hifpCGHX2s6dnfrrRWjroOPzB0T0+zZ0q8uDRSrniF/MB8X2fADhR8IRRRDphh7Q6rbgtOucU0Sdnj59Z2hb00PtHD+Zp/p2x6uitO4o7iLYP8DMafjVE2wXUboALm50W2ahtXO3q8MTX02fnh0Affu/IkSAXnL55dLzMPU6kURZMIZQhFtRk2VBKcpQTIQVZ21hrdUX4zDcnPv2kBzr59mP3BLnChfGx8YrHPKIAELSzMPhQk+ydzpOvIYwywjFeK7K+vt6IlZw8/+y5RZ4gm9eCUrGCmkUyBkCV0Sd5UlBtTLIhRWQE9ixwsVwe6dY3X4WwJ+j9bx7a7/v5i6O7qlxisFZJAvBF7Rjty56CWlmszilj6BNgXd+syTCO7uNK62nuezyUkWWASTPHDtOjbgOHkJTOsbXAyJhIC+rlODdROM211gcQKBJxoh+EKAs4AGqybHVfBvdICNIU/IDHYbcJiS6le4wwbW1B9UDXJcg9QBxtbglh1BlAJzjoUxIGQZFRwtAypgnjtH0spDG9MWVs34xrN5uBLnEoTKQUgDLgZ6hliLunBaIDhy4LYhyotptZlphGyLUhfyspxxj3AIpaVqikdgyzoGn7p0xNj71rNamweCscWC0qoQ8YRm3K2OgpeFoc+j9FSUYKB+4OgxIK4RcZUJ6RsUgqCrShxWzza9035aw/lzYGY5P4xFSMR5vMcFpm87opL4HjXsr76dLhC2xYhgx3I0BfoS7RCp+3K/e8vn+Ke2zWK+cYofQG9yMlw1eK1aAni9oSWil9eOmFhXkPnbXZ1eXqwVsirfQU9Vynm75lymLbxvpSP4yqI4iR5uWlFxdOI56Xbro5t3qhOrW7ZmL1EOFwp7k6pRXuWaZgBmuwJSIl1fNXXvrxjRTLy2ZTm1v9YeTBXedNbCYZZ1U4pdt+NGiomuKKEvKp5ZM/f5z9zctc1vju1b9cv5q/M/icBd4+KNztlnGWKfYjAMqm+K7zZ/PYP6d+X3TrafbmR8N71QcrOPMLd5RGdj838WFup393orNLWRki6vFv197661i40m6AKwYLneG79BzDPNhNYFWwnfguGyKgPl32bwseoTnKekVpS9n49vorWwv1JsSVwAJHCHcW2Agsk3rBBZXBihhcn11biTfDixpPik1bEZyj34EVXXzJrUccWwrbZo5+B6ztRpvO1kLjjO5qW3YccZ5JeTAecQxqqV0Q6hM5KVIrNL5a/77yQPUyLbK9qiMv49zFhW6MMnPE0dwxlQ48ckXDNHJOq0C2xByreHtxhPk1sK4DEI5dut7+QWCZCyj9MXKLWmD/gl1Xtfhd6F2CI86dv+XiIrdOpeeCDd0VyW7KGbLptn9p/mrgNsIxwzKN0QO3IvlPgAEA3AQhIZtaN54AAAAASUVORK5CYII=&quot;</span><span class="p">,</span>
                       <span class="s">&quot;contentType&quot;</span><span class="p">:</span><span class="s">&quot;image/png&quot;</span><span class="p">,</span>
                       <span class="s">&quot;width&quot;</span><span class="p">:</span><span class="mf">15.75</span><span class="p">,</span>
                       <span class="s">&quot;height&quot;</span><span class="p">:</span><span class="mf">21.75</span>
                    <span class="p">}</span>
                 <span class="p">}</span>
              <span class="p">],</span>
              <span class="s">&quot;geometryType&quot;</span><span class="p">:</span><span class="s">&quot;esriGeometryPoint&quot;</span>
           <span class="p">},</span>
           <span class="s">&quot;nextObjectId&quot;</span><span class="p">:</span><span class="mi">1</span>
        <span class="p">}</span>

        <span class="n">input_layer_url</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">input_layer</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;feature service&#39;</span><span class="p">:</span>
                <span class="n">fs</span> <span class="o">=</span> <span class="n">FeatureService</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
                <span class="n">input_layer_url</span> <span class="o">=</span>  <span class="n">fs</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">url</span> <span class="c">#[&quot;url&quot;]</span>
                <span class="n">input_param</span> <span class="o">=</span>  <span class="p">{</span><span class="s">&quot;url&quot;</span><span class="p">:</span> <span class="n">input_layer_url</span> <span class="p">}</span>
            <span class="k">elif</span> <span class="n">input_layer</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;feature collection&#39;</span><span class="p">:</span>
                <span class="n">fcdict</span> <span class="o">=</span> <span class="n">input_layer</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
                <span class="n">fc</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">fcdict</span><span class="p">[</span><span class="s">&#39;layers&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">input_param</span> <span class="o">=</span>  <span class="n">fc</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;item type must be feature service or feature collection&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">FeatureService</span><span class="p">):</span>
            <span class="n">input_layer_url</span> <span class="o">=</span> <span class="n">input_layer</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">url</span> <span class="c">#[&quot;url&quot;]</span>
            <span class="n">input_param</span> <span class="o">=</span>  <span class="p">{</span><span class="s">&quot;url&quot;</span><span class="p">:</span> <span class="n">input_layer_url</span> <span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="n">Layer</span><span class="p">):</span>
            <span class="n">input_layer_url</span> <span class="o">=</span> <span class="n">input_layer</span><span class="o">.</span><span class="n">url</span>
            <span class="n">input_param</span> <span class="o">=</span>  <span class="p">{</span><span class="s">&quot;url&quot;</span><span class="p">:</span> <span class="n">input_layer_url</span> <span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span> <span class="c"># geocoder location, convert to point featureset</span>
            <span class="n">input_param</span> <span class="o">=</span> <span class="n">point_fs</span>
            <span class="n">input_param</span><span class="p">[</span><span class="s">&quot;featureSet&quot;</span><span class="p">][</span><span class="s">&quot;features&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">&quot;geometry&quot;</span><span class="p">][</span><span class="s">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_layer</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">input_param</span><span class="p">[</span><span class="s">&quot;featureSet&quot;</span><span class="p">][</span><span class="s">&quot;features&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">&quot;geometry&quot;</span><span class="p">][</span><span class="s">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_layer</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span> <span class="c"># could add support for geometry one day using geometry -&gt; featureset</span>
            <span class="n">input_param</span> <span class="o">=</span>  <span class="n">input_layer</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            res = gis.analysis.trace_downstream({&quot;layerDefinition&quot;:</span>
<span class="sd">                {</span>
<span class="sd">                    &quot;geometryType&quot;:&quot;esriGeometryPoint&quot;,</span>
<span class="sd">                    &quot;fields&quot;:[{&quot;alias&quot;:&quot;OBJECTID&quot;,&quot;name&quot;:&quot;OBJECTID&quot;,&quot;type&quot;:&quot;esriFieldTypeOID&quot;,&quot;editable&quot;:False},</span>
<span class="sd">                              {&quot;alias&quot;:&quot;Title&quot;,&quot;name&quot;:&quot;TITLE&quot;,&quot;length&quot;:50,&quot;type&quot;:&quot;esriFieldTypeString&quot;,&quot;editable&quot;:True},</span>
<span class="sd">                              {&quot;alias&quot;:&quot;Visible&quot;,&quot;name&quot;:&quot;VISIBLE&quot;,&quot;type&quot;:&quot;esriFieldTypeInteger&quot;,&quot;editable&quot;:True},</span>
<span class="sd">                              {&quot;alias&quot;:&quot;Description&quot;,&quot;name&quot;:&quot;DESCRIPTION&quot;,&quot;length&quot;:1073741822,&quot;type&quot;:&quot;esriFieldTypeString&quot;,&quot;editable&quot;:True},</span>
<span class="sd">                              {&quot;alias&quot;:&quot;Type ID&quot;,&quot;name&quot;:&quot;TYPEID&quot;,&quot;type&quot;:&quot;esriFieldTypeInteger&quot;,&quot;editable&quot;:True}]</span>
<span class="sd">                },</span>
<span class="sd">                &quot;featureSet&quot;:{</span>
<span class="sd">                    &quot;features&quot;:[</span>
<span class="sd">                        {</span>
<span class="sd">                            &quot;geometry&quot;:{</span>
<span class="sd">                                &quot;x&quot;:8913583.679975435,</span>
<span class="sd">                                &quot;y&quot;:1460497.641278398,</span>
<span class="sd">                                &quot;spatialReference&quot;:{&quot;wkid&quot;:102100,&quot;latestWkid&quot;:3857}</span>
<span class="sd">                            },</span>
<span class="sd">                            &quot;attributes&quot;:{&quot;description&quot;:&quot;blayer desc&quot;,&quot;title&quot;:&quot;blayer&quot;,&quot;OBJECTID&quot;:0,&quot;VISIBLE&quot;:1},</span>
<span class="sd">                </span>
<span class="sd">                        }</span>
<span class="sd">                    ],</span>
<span class="sd">                    &quot;geometryType&quot;:&quot;esriGeometryPoint&quot;</span>
<span class="sd">                },</span>
<span class="sd">                &quot;nextObjectId&quot;:1</span>
<span class="sd">            })</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_layer</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">input_layer_url</span> <span class="o">=</span> <span class="n">input_layer</span>
            <span class="n">input_param</span> <span class="o">=</span>  <span class="p">{</span><span class="s">&quot;url&quot;</span><span class="p">:</span> <span class="n">input_layer_url</span> <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Invalid format of input layer. url string, feature service Item, feature service instance or dict supported&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">input_param</span>

    <span class="k">def</span> <span class="nf">_raster_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_raster</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_raster</span><span class="p">,</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">input_raster</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;image service&#39;</span><span class="p">:</span>
                <span class="n">input_param</span> <span class="o">=</span>  <span class="p">{</span><span class="s">&quot;itemId&quot;</span><span class="p">:</span> <span class="n">input_raster</span><span class="o">.</span><span class="n">itemid</span> <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;item type must be image service&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_raster</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">input_param</span> <span class="o">=</span>  <span class="p">{</span><span class="s">&quot;url&quot;</span><span class="p">:</span> <span class="n">input_raster</span> <span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_raster</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">input_param</span> <span class="o">=</span>  <span class="n">input_raster</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Invalid format of input raster. image service Item or image service url, cloud raster uri or shared data path supported&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">input_param</span>

<span class="k">def</span> <span class="nf">_call_generator</span><span class="p">(</span><span class="n">fnname</span><span class="p">,</span> <span class="n">spec</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generate GP function based on spec</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">varnames</span><span class="p">,</span> <span class="n">defaults</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">spec</span><span class="p">)</span>
    <span class="n">varnames</span> <span class="o">=</span> <span class="p">(</span><span class="s">&#39;self&#39;</span><span class="p">,</span> <span class="p">)</span> <span class="o">+</span> <span class="n">varnames</span>


    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method to invoke the Geoprocessing task&quot;&quot;&quot;</span>
        <span class="c">#import sys</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;self&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="c"># args, posargs = self.arguments()</span>

        <span class="c">#print(&quot;My args: &quot;)</span>
        <span class="c">#for k, v in kwargs.items():</span>
        <span class="c">#    print(k + &quot; =&gt; &quot; + str(v))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_execute</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="n">code</span> <span class="o">=</span> <span class="n">call</span><span class="o">.</span><span class="n">__code__</span>
    <span class="n">new_code</span> <span class="o">=</span> <span class="n">types</span><span class="o">.</span><span class="n">CodeType</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                              <span class="mi">0</span><span class="p">,</span>
                              <span class="nb">len</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>
                              <span class="n">code</span><span class="o">.</span><span class="n">co_stacksize</span><span class="p">,</span>
                              <span class="n">code</span><span class="o">.</span><span class="n">co_flags</span><span class="p">,</span>
                              <span class="n">code</span><span class="o">.</span><span class="n">co_code</span><span class="p">,</span>
                              <span class="n">code</span><span class="o">.</span><span class="n">co_consts</span><span class="p">,</span>
                              <span class="n">code</span><span class="o">.</span><span class="n">co_names</span><span class="p">,</span>
                              <span class="n">varnames</span><span class="p">,</span>
                              <span class="n">code</span><span class="o">.</span><span class="n">co_filename</span><span class="p">,</span>
                              <span class="n">fnname</span><span class="p">,</span>
                              <span class="n">code</span><span class="o">.</span><span class="n">co_firstlineno</span><span class="p">,</span>
                              <span class="n">code</span><span class="o">.</span><span class="n">co_lnotab</span><span class="p">,</span>
                              <span class="n">code</span><span class="o">.</span><span class="n">co_freevars</span><span class="p">,</span>
                              <span class="n">code</span><span class="o">.</span><span class="n">co_cellvars</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;    </span>
<span class="sd">     * co_name gives the function name </span>
<span class="sd">     * co_argcount is the number of positional arguments (including </span>
<span class="sd">    arguments with default values) </span>
<span class="sd">     * co_nlocals is the number of local variables used by the function </span>
<span class="sd">    (including arguments) </span>
<span class="sd">     * co_varnames is a tuple containing the names of the local </span>
<span class="sd">    variables (starting with the argument names) </span>
<span class="sd">     * co_cellvars is a tuple containing the names of local variables </span>
<span class="sd">    that are referenced by nested functions </span>
<span class="sd">     * co_freevars is a tuple containing the names of free variables </span>
<span class="sd">     * co_code is a string representing the sequence of bytecode </span>
<span class="sd">    instructions </span>
<span class="sd">     * co_consts is a tuple containing the literals used by the bytecode </span>
<span class="sd">     * co_names is a tuple containing the names used by the bytecode </span>
<span class="sd">     * co_filename is the filename from which the code was compiled </span>
<span class="sd">     * co_firstlineno is the first line number of the function </span>
<span class="sd">     * co_lnotab is a string encoding the mapping from byte code offsets </span>
<span class="sd">    to line numbers (for details see the source code of the interpreter) </span>
<span class="sd">     * co_stacksize is the required stack size (including local </span>
<span class="sd">    variables) </span>
<span class="sd">     * co_flags is an integer encoding a number of flags for the </span>
<span class="sd">    interpreter. </span>
<span class="sd">    &quot;&quot;&quot;</span>




    <span class="k">return</span> <span class="n">types</span><span class="o">.</span><span class="n">FunctionType</span><span class="p">(</span><span class="n">new_code</span><span class="p">,</span>
                              <span class="p">{</span><span class="s">&quot;__builtins__&quot;</span><span class="p">:</span> <span class="n">__builtins__</span><span class="p">},</span>
                              <span class="n">argdefs</span><span class="o">=</span><span class="n">defaults</span><span class="p">)</span>

<span class="c"># GP Data types: http://resources.arcgis.com/en/help/main/10.1/index.html#//005700000070000000    </span>
<div class="viewcode-block" id="GeoprocessingTool"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoprocessingTool">[docs]</a><span class="k">class</span> <span class="nc">GeoprocessingTool</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">):</span>
    <span class="s">&quot;represents a geoprocessing service&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a Geoprocessing Service object given it&#39;s item from ArcGIS Online or Portal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&#39;geoprocessing service&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;item type must be geoprocessing service&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="n">item</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">url</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_taskurls</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_method_params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&quot;URL: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>
        <span class="n">svcprops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">use_ordered_dict</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">svcprops</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">svcprops</span><span class="p">[</span><span class="s">&#39;tasks&#39;</span><span class="p">]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Task: &quot;</span> <span class="o">+</span> <span class="n">task</span><span class="p">)</span>
            <span class="n">fnname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_camelCase_to_underscore</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

            <span class="n">taskurl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="n">task</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">_taskurls</span><span class="p">[</span><span class="n">fnname</span><span class="p">]</span> <span class="o">=</span> <span class="n">taskurl</span> <span class="o">+</span> <span class="s">&quot;/execute&quot;</span>

            <span class="n">taskprops</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">taskurl</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
            <span class="n">execution_type</span> <span class="o">=</span> <span class="n">taskprops</span><span class="p">[</span><span class="s">&#39;executionType&#39;</span><span class="p">]</span>
            <span class="n">task_params</span> <span class="o">=</span> <span class="n">taskprops</span><span class="p">[</span><span class="s">&#39;parameters&#39;</span><span class="p">]</span>

            <span class="n">helpstring</span> <span class="o">=</span> <span class="n">taskprops</span><span class="p">[</span><span class="s">&quot;displayName&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="k">if</span> <span class="s">&#39;docstring&#39;</span> <span class="ow">in</span> <span class="n">taskprops</span><span class="p">:</span>
                <span class="n">helpstring</span> <span class="o">=</span> <span class="n">helpstring</span> <span class="o">+</span> <span class="s">&quot;. &quot;</span> <span class="o">+</span> <span class="n">taskprops</span><span class="p">[</span><span class="s">&#39;docstring&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Parameters:</span><span class="se">\n</span><span class="s">&quot;</span>


            <span class="n">spec</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">name_type</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">task_params</span><span class="p">:</span>
                
                <span class="n">param_name</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
                
                <span class="n">param_type</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s">&#39;dataType&#39;</span><span class="p">]</span>
                <span class="n">param_dval</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s">&#39;defaultValue&#39;</span><span class="p">]</span>
                <span class="n">param_drtn</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s">&#39;direction&#39;</span><span class="p">]</span>
                
                <span class="n">param_rqrd</span> <span class="o">=</span> <span class="n">param</span><span class="p">[</span><span class="s">&#39;parameterType&#39;</span><span class="p">]</span>
                
                <span class="k">if</span> <span class="n">param_type</span> <span class="o">==</span> <span class="s">&#39;GPFeatureRecordSetLayer&#39;</span><span class="p">:</span>
                    <span class="n">param_dval</span> <span class="o">=</span> <span class="bp">None</span>

                <span class="n">py_param_type_</span> <span class="o">=</span> <span class="n">param_type</span>
                <span class="k">if</span> <span class="n">param_type</span> <span class="o">==</span> <span class="s">&#39;GPBoolean&#39;</span><span class="p">:</span>
                    <span class="n">py_param_type_</span> <span class="o">=</span> <span class="nb">bool</span>
                <span class="k">elif</span> <span class="n">param_type</span> <span class="o">==</span> <span class="s">&#39;GPDouble&#39;</span><span class="p">:</span>
                    <span class="n">py_param_type_</span> <span class="o">=</span> <span class="nb">float</span>
                <span class="k">elif</span> <span class="n">param_type</span> <span class="o">==</span> <span class="s">&#39;GPLong&#39;</span><span class="p">:</span>
                    <span class="n">py_param_type_</span> <span class="o">=</span> <span class="nb">int</span>
                <span class="k">elif</span> <span class="n">param_type</span> <span class="o">==</span> <span class="s">&#39;GPString&#39;</span><span class="p">:</span>
                    <span class="n">py_param_type_</span> <span class="o">=</span> <span class="nb">str</span>
                <span class="k">elif</span> <span class="n">param_type</span> <span class="o">==</span> <span class="s">&#39;GPDate&#39;</span><span class="p">:</span>
                    <span class="n">py_param_type_</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">date</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">py_param_type_</span> <span class="o">=</span> <span class="n">param_type</span>


                <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                GPDataFile	DataFile</span>
<span class="sd">                GPFeatureRecordSetLayer	FeatureSet</span>
<span class="sd">                GPLinearUnit	LinearUnit</span>
<span class="sd">                GPRasterData	RasterData</span>
<span class="sd">                GPRasterLayer	RasterData</span>
<span class="sd">                GPRecordSet	FeatureSet</span>
<span class="sd">                &quot;&quot;&quot;</span> 

                <span class="k">if</span> <span class="n">param_drtn</span> <span class="o">==</span> <span class="s">&#39;esriGPParameterDirectionInput&#39;</span><span class="p">:</span>
                    <span class="n">name_type</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">py_param_type_</span>
                    <span class="k">print</span><span class="p">(</span><span class="n">param_name</span> <span class="o">+</span> <span class="s">&quot; : &quot;</span> <span class="o">+</span> <span class="n">param_type</span><span class="p">)</span>
                    <span class="c">#if param_dval is not None and param_dval != &#39;&#39;:</span>
                    <span class="c">#    print(&quot; = &quot; + str(param_dval))</span>
                    <span class="k">if</span> <span class="n">param_rqrd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">param_rqrd</span> <span class="o">==</span> <span class="s">&#39;esriGPParameterTypeOptional&#39;</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span class="s">&quot; = None&quot;</span><span class="p">)</span>
                    <span class="n">param_spec</span> <span class="o">=</span> <span class="p">(</span> <span class="n">param_name</span> <span class="p">,</span> <span class="n">param_dval</span> <span class="p">)</span>
                    <span class="n">spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param_spec</span><span class="p">)</span>

                    <span class="n">helpstring</span> <span class="o">=</span> <span class="n">helpstring</span> <span class="o">+</span> <span class="s">&quot;   &quot;</span> <span class="o">+</span> <span class="n">param_name</span> <span class="o">+</span> <span class="s">&quot;: &quot;</span> <span class="o">+</span> <span class="n">param</span><span class="p">[</span><span class="s">&#39;displayName&#39;</span><span class="p">]</span>  <span class="o">+</span> <span class="s">&quot; (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">py_param_type_</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
                    <span class="k">if</span> <span class="n">param_rqrd</span> <span class="o">==</span> <span class="s">&#39;esriGPParameterTypeOptional&#39;</span><span class="p">:</span>
                        <span class="n">helpstring</span> <span class="o">=</span> <span class="n">helpstring</span> <span class="o">+</span> <span class="s">&quot; Optional parameter. &quot;</span>
                    <span class="k">elif</span> <span class="n">param_rqrd</span> <span class="o">==</span> <span class="s">&#39;esriGPParameterTypeRequired&#39;</span><span class="p">:</span>
                        <span class="n">helpstring</span> <span class="o">=</span> <span class="n">helpstring</span> <span class="o">+</span> <span class="s">&quot; Required parameter. &quot;</span>

                    <span class="k">if</span> <span class="s">&#39;description&#39;</span> <span class="ow">in</span> <span class="n">param</span><span class="p">:</span>
                        <span class="n">helpstring</span> <span class="o">=</span> <span class="n">helpstring</span> <span class="o">+</span> <span class="n">param</span><span class="p">[</span><span class="s">&#39;description&#39;</span><span class="p">]</span>

                <span class="k">elif</span> <span class="n">param_drtn</span> <span class="o">==</span> <span class="s">&#39;esriGPParameterDirectionOutput&#39;</span><span class="p">:</span>
                    <span class="n">name_type</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">py_param_type_</span>
                    
                    <span class="n">helpstring</span> <span class="o">=</span> <span class="n">helpstring</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">Returns &quot;</span> <span class="o">+</span> <span class="n">param</span><span class="p">[</span><span class="s">&#39;displayName&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;(&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">py_param_type_</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span>
                
                <span class="n">helpstring</span> <span class="o">=</span> <span class="n">helpstring</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>

            <span class="k">if</span> <span class="s">&#39;helpUrl&#39;</span> <span class="ow">in</span> <span class="n">taskprops</span><span class="p">:</span>
                <span class="n">helpstring</span> <span class="o">=</span> <span class="n">helpstring</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">See &quot;</span> <span class="o">+</span> <span class="n">taskprops</span><span class="p">[</span><span class="s">&#39;helpUrl&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot; for additional help.&quot;</span>
            
            <span class="n">generatedfn</span> <span class="o">=</span> <span class="n">_call_generator</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">spec</span><span class="p">)</span>
            <span class="n">generatedfn</span><span class="o">.</span><span class="n">__annotations__</span> <span class="o">=</span> <span class="n">name_type</span>
            <span class="n">generatedfn</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">=</span> <span class="n">helpstring</span>

            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fnname</span><span class="p">,</span> <span class="n">types</span><span class="o">.</span><span class="n">MethodType</span><span class="p">(</span><span class="n">generatedfn</span><span class="p">,</span> <span class="bp">self</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_method_params</span><span class="p">[</span><span class="n">task</span><span class="p">]</span> <span class="o">=</span> <span class="n">name_type</span>

        <span class="c"># http://www.arcgis.com/home/item.html?id=383c2039b89d43baa0010c3bf243b144</span>
        <span class="c"># http://sampleserver1.arcgisonline.com/ArcGIS/rest/Services/Specialty/ESRI_Currents_World/GPServer</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="n">caller_fnname</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="n">caller_fnname</span> <span class="o">+</span> <span class="s">&quot;/execute&quot;</span>
        <span class="c">#print(&quot;Will call &quot; + url +  &quot; with these parameters:&quot;)</span>
        
        <span class="n">name_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_method_params</span><span class="p">[</span><span class="n">caller_fnname</span><span class="p">]</span>

        <span class="n">params</span><span class="o">.</span><span class="n">update</span><span class="p">({</span> <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span> <span class="p">})</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c">#print(k + &quot; = &quot; + str(v))</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">name_type</span><span class="p">:</span>
                <span class="n">py_type</span> <span class="o">=</span> <span class="n">name_type</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">py_type</span> <span class="o">==</span> <span class="s">&#39;GPFeatureRecordSetLayer&#39;</span><span class="p">:</span>
                    <span class="n">geometry</span> <span class="o">=</span> <span class="n">v</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">val</span><span class="p">[</span><span class="s">&#39;geometryType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;esriGeometryPoint&#39;</span>
                    <span class="n">val</span><span class="p">[</span><span class="s">&#39;features&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s">&quot;geometry&quot;</span> <span class="p">:</span> <span class="n">geometry</span><span class="p">}]</span>
                    <span class="n">val</span><span class="p">[</span><span class="s">&#39;sr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;wkid&quot;</span><span class="p">:</span><span class="mi">102100</span><span class="p">,</span><span class="s">&quot;latestWkid&quot;</span><span class="p">:</span><span class="mi">3857</span><span class="p">}</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="c">#params[k] = &quot;&quot;&quot;{&quot;geometryType&quot;:&quot;esriGeometryPoint&quot;, &quot;features&quot;:&quot;&quot;&quot; + json.dumps(geometry) + &quot;&quot;&quot;,&quot;sr&quot;:{&quot;wkid&quot;:102100,&quot;latestWkid&quot;:3857}}&quot;&quot;&quot;</span>
                    <span class="c">#print(&quot;Updated&quot; + k + &quot; to &quot; + json.dumps(params[k]))</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">ret_type</span> <span class="o">=</span> <span class="n">name_type</span><span class="p">[</span><span class="s">&#39;return&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">geometries</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">if</span> <span class="n">ret_type</span> <span class="o">==</span> <span class="s">&#39;GPFeatureRecordSetLayer&#39;</span><span class="p">:</span>
                <span class="c">#print(&quot;RESP IN GP:&quot;+str(resp))</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">resp</span><span class="p">[</span><span class="s">&#39;results&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;value&#39;</span><span class="p">]</span>
                <span class="n">geom_type</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s">&#39;geometryType&#39;</span><span class="p">]</span>
                <span class="n">sr</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s">&#39;spatialReference&#39;</span><span class="p">]</span>

                <span class="n">geo_geom_type</span> <span class="o">=</span> <span class="n">geom_type</span><span class="o">.</span><span class="n">lower</span><span class="p">()[</span><span class="nb">len</span><span class="p">(</span><span class="s">&quot;esriGeometry&quot;</span><span class="p">):]</span>

                <span class="n">features</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s">&#39;features&#39;</span><span class="p">]</span>
                <span class="n">geometries</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
                    <span class="n">geometry</span> <span class="o">=</span> <span class="n">feature</span><span class="p">[</span><span class="s">&#39;geometry&#39;</span><span class="p">]</span>
                    <span class="n">geometry</span><span class="p">[</span><span class="s">&#39;spatialReference&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sr</span>
                    <span class="n">geometry</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo_geom_type</span>

                    <span class="n">geometries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">geometries</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Error: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">resp</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">resp</span>
        
            
<div class="viewcode-block" id="GeoprocessingTool.execute"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoprocessingTool.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task</span><span class="p">,</span> <span class="nb">input</span><span class="p">,</span>
                <span class="n">outSR</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">processSR</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                <span class="n">returnZ</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">returnM</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        
        <span class="c"># http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Specialty/ESRI_Currents_World/GPServer/MessageInABottle/execute? Input_Point={&quot;features&quot;:[{&quot;geometry&quot;:{&quot;x&quot;:0,&quot;y&quot;:0}}]}&amp; Days=50</span>
        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">+</span> <span class="s">&quot;/&quot;</span> <span class="o">+</span> <span class="n">task</span> <span class="o">+</span> <span class="s">&quot;/execute&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">outSR</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;outSR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outSR</span>
        <span class="k">if</span> <span class="n">processSR</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;processSR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processSR</span>
        <span class="k">if</span> <span class="n">returnZ</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;returnZ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;true&quot;</span>
        <span class="k">if</span> <span class="n">returnM</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&#39;returnM&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;true&quot;</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">input</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">item</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>
</div>
    <span class="k">def</span> <span class="nf">_camelCase_to_underscore</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">s1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39;(.)([A-Z][a-z]+)&#39;</span><span class="p">,</span> <span class="s">r&#39;\1_\2&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39;([a-z0-9])([A-Z])&#39;</span><span class="p">,</span> <span class="s">r&#39;\1_\2&#39;</span><span class="p">,</span> <span class="n">s1</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="GeoAnalyticsTools"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools">[docs]</a><span class="k">class</span> <span class="nc">GeoAnalyticsTools</span><span class="p">(</span><span class="n">_AsyncService</span><span class="p">):</span>
    <span class="s">&quot;Represents the GeoAnalyticsTools service. The GeoAnalyticsTools service is provided for distributed analysis of large datasets.&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">gis</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a client to the service given it&#39;s url from ArcGIS Online or Portal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">gis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gis</span> <span class="o">=</span> <span class="n">gis</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="GeoAnalyticsTools.list_bigdata_datasets"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.list_bigdata_datasets">[docs]</a>    <span class="k">def</span> <span class="nf">list_bigdata_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_path</span><span class="p">):</span>
        <span class="n">fedservers_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_url</span> <span class="o">+</span> <span class="s">&quot;portaladmin/federation/servers?f=json&quot;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fedservers_url</span><span class="p">)</span>
        <span class="n">servers</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;servers&#39;</span><span class="p">]</span>
        <span class="n">admin_url</span> <span class="o">=</span> <span class="n">_get_hosted_server_admin_url</span><span class="p">(</span><span class="n">servers</span><span class="p">)</span>
        <span class="n">data_item_manifest_url</span> <span class="o">=</span> <span class="n">admin_url</span> <span class="o">+</span> <span class="s">&#39;/data/items/bigDataFileShares/&#39;</span> <span class="o">+</span> <span class="n">server_path</span> <span class="o">+</span> <span class="s">&quot;/manifest&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;json&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">data_item_manifest_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;datasets&#39;</span><span class="p">]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;/server/datastores/bigDataFileShares/&quot;</span> <span class="o">+</span> <span class="n">server_path</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="n">dataset</span><span class="p">[</span><span class="s">&#39;path&#39;</span><span class="p">]</span> <span class="o">+</span> 
                  <span class="s">&#39; (&#39;</span><span class="o">+</span> <span class="n">dataset</span><span class="p">[</span><span class="s">&#39;type&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;)&#39;</span><span class="p">)</span>
            
</div>
<div class="viewcode-block" id="GeoAnalyticsTools.register_bigdata_fileshare"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.register_bigdata_fileshare">[docs]</a>    <span class="k">def</span> <span class="nf">register_bigdata_fileshare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_path</span><span class="p">,</span> <span class="n">fileshare_path</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">admin_url</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="c">#server_path = &quot;gae3&quot;</span>
        <span class="c">#fileshare_path = &quot;\\\\dev06999\\bigdata\\data&quot;</span>
        <span class="c">#local_path = &#39;C:\\bigdata\\data&#39;</span>

        <span class="k">if</span> <span class="n">admin_url</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">fedservers_url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_url</span> <span class="o">+</span> <span class="s">&quot;portaladmin/federation/servers?f=json&quot;</span>
            <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fedservers_url</span><span class="p">)</span>
            <span class="n">servers</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;servers&#39;</span><span class="p">]</span>
            <span class="n">admin_url</span> <span class="o">=</span> <span class="n">_get_hosted_server_admin_url</span><span class="p">(</span><span class="n">servers</span><span class="p">)</span>

        <span class="n">register_data_item_url</span> <span class="o">=</span> <span class="n">admin_url</span> <span class="o">+</span> <span class="s">&#39;/data/registerItem&#39;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;json&#39;</span><span class="p">,</span>
            <span class="s">&#39;item&#39;</span> <span class="p">:</span> <span class="p">{</span>
              <span class="s">&quot;path&quot;</span><span class="p">:</span> <span class="s">&quot;/bigDataFileShares&quot;</span><span class="p">,</span>
              <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;datadir&quot;</span><span class="p">,</span>
              <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
              <span class="s">&quot;clientPath&quot;</span><span class="p">:</span> <span class="bp">None</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">register_data_item_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;success&#39;</span><span class="p">]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Created Big Data file shares data directory&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;exists&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Big Data file share exists&quot;</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;json&#39;</span><span class="p">,</span>
            <span class="s">&#39;item&#39;</span> <span class="p">:</span> <span class="p">{</span>
              <span class="s">&quot;path&quot;</span><span class="p">:</span> <span class="s">&quot;/fileShares/_raster_store&quot;</span><span class="p">,</span>
              <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;folder&quot;</span><span class="p">,</span>
              <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
              <span class="s">&quot;info&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">&quot;dataStoreConnectionType&quot;</span><span class="p">:</span> <span class="s">&quot;shared&quot;</span><span class="p">,</span>
                    <span class="s">&quot;path&quot;</span><span class="p">:</span> <span class="n">fileshare_path</span>
              <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">register_data_item_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;success&#39;</span><span class="p">]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Created Raster Store&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;exists&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Raster Store exists&quot;</span><span class="p">)</span>


        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&#39;f&#39;</span><span class="p">:</span> <span class="s">&#39;json&#39;</span><span class="p">,</span>
            <span class="s">&#39;item&#39;</span> <span class="p">:</span> <span class="p">{</span>
              <span class="s">&quot;path&quot;</span><span class="p">:</span> <span class="s">&quot;/bigDataFileShares/&quot;</span> <span class="o">+</span> <span class="n">server_path</span><span class="p">,</span>
              <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;bigDataFileShare&quot;</span><span class="p">,</span>
              <span class="s">&quot;id&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;</span><span class="p">,</span>
              <span class="s">&quot;info&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s">&quot;path&quot;</span> <span class="p">:</span> <span class="n">fileshare_path</span>
               <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">register_data_item_url</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;success&#39;</span><span class="p">]:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Created Big Data file share for &quot;</span> <span class="o">+</span> <span class="n">server_path</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;exists&#39;</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Big Data file share exists for &quot;</span> <span class="o">+</span> <span class="n">server_path</span><span class="p">)</span>

        <span class="n">manifest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_manifest</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span>
        <span class="c">#print(manifest)</span>
        <span class="n">manifest_upload_url</span> <span class="o">=</span>  <span class="n">admin_url</span> <span class="o">+</span> <span class="s">&#39;/data/items/bigDataFileShares/&#39;</span> <span class="o">+</span> <span class="n">server_path</span> <span class="o">+</span> <span class="s">&#39;/manifest/update&#39;</span>

        <span class="k">with</span> <span class="n">_tempinput</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">manifest</span><span class="p">))</span> <span class="k">as</span> <span class="n">tempfilename</span><span class="p">:</span>
            <span class="c"># Build the files list (tuples)</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s">&#39;manifest&#39;</span><span class="p">,</span> <span class="n">tempfilename</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">tempfilename</span><span class="p">)))</span>
    
            <span class="n">postdata</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&#39;f&#39;</span> <span class="p">:</span> <span class="s">&#39;pjson&#39;</span>
            <span class="p">}</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">manifest_upload_url</span><span class="p">,</span> <span class="n">postdata</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
    
            <span class="k">if</span> <span class="n">resp</span><span class="p">[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;success&#39;</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&quot;Uploaded/updated manifest&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.aggregate_points_by_bins"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.aggregate_points_by_bins">[docs]</a>    <span class="k">def</span> <span class="nf">aggregate_points_by_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_points</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_points_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_distance_interval</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_timestep_interval</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_timestep_repeat</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_timestep_reference_time</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_summary_stats</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_features_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_points : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_points_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_distance_interval : Optional LinearUnit</span>
<span class="sd">            </span>
<span class="sd">        in_timestep_interval : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_timestep_repeat : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_timestep_reference_time : Optional datetime.date</span>
<span class="sd">            </span>
<span class="sd">        in_summary_stats : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features_name : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Aggregate Points By Bins&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_points&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_points</span>
        <span class="k">if</span> <span class="n">in_points_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_points_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_points_layer</span>
        <span class="k">if</span> <span class="n">in_distance_interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_distance_interval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_distance_interval</span>
        <span class="k">if</span> <span class="n">in_timestep_interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_timestep_interval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_timestep_interval</span>
        <span class="k">if</span> <span class="n">in_timestep_repeat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_timestep_repeat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_timestep_repeat</span>
        <span class="k">if</span> <span class="n">in_timestep_reference_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_timestep_reference_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_timestep_reference_time</span>
        <span class="k">if</span> <span class="n">in_summary_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_summary_stats&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_summary_stats</span>
        <span class="k">if</span> <span class="n">out_features_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;out_features_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_features_name</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.describe_dataset"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.describe_dataset">[docs]</a>    <span class="k">def</span> <span class="nf">describe_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_dataset</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_dataset_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_dataset : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_dataset_layer : Optional FeatureSet</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        output_json : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Describe Dataset&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_dataset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_dataset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_dataset</span>
        <span class="k">if</span> <span class="n">in_dataset_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_dataset_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_dataset_layer</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;output_json&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;output_json&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.aggregate_points_by_polygons"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.aggregate_points_by_polygons">[docs]</a>    <span class="k">def</span> <span class="nf">aggregate_points_by_polygons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_points</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_points_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_polygons</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_polygons_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_timestep_interval</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_timestep_repeat</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_timestep_reference_time</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_summary_stats</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_features_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_points : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_points_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_polygons : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_polygons_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_timestep_interval : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_timestep_repeat : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_timestep_reference_time : Optional datetime.date</span>
<span class="sd">            </span>
<span class="sd">        in_summary_stats : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features_name : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Aggregate Points By Polygons&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_points&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_points</span>
        <span class="k">if</span> <span class="n">in_points_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_points_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_points_layer</span>
        <span class="k">if</span> <span class="n">in_polygons</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_polygons&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_polygons</span>
        <span class="k">if</span> <span class="n">in_polygons_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_polygons_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_polygons_layer</span>
        <span class="k">if</span> <span class="n">in_timestep_interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_timestep_interval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_timestep_interval</span>
        <span class="k">if</span> <span class="n">in_timestep_repeat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_timestep_repeat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_timestep_repeat</span>
        <span class="k">if</span> <span class="n">in_timestep_reference_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_timestep_reference_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_timestep_reference_time</span>
        <span class="k">if</span> <span class="n">in_summary_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_summary_stats&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_summary_stats</span>
        <span class="k">if</span> <span class="n">out_features_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;out_features_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_features_name</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.feature_join"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.feature_join">[docs]</a>    <span class="k">def</span> <span class="nf">feature_join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_target_features</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_target_features_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_join_features</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_join_features_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_join_operation</span><span class="o">=</span><span class="s">&quot;Summarize Join Features&quot;</span><span class="p">,</span>
                       <span class="n">in_summary_stats</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_spatial_relationship</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_spatial_distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_temporal_relationship</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_temporal_distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_attribute_relationship</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_features_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="mi">3857</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_target_features : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_target_features_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_join_features : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_join_features_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_join_operation : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_summary_stats : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_spatial_relationship : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_spatial_distance : Optional LinearUnit</span>
<span class="sd">            </span>
<span class="sd">        in_temporal_relationship : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_temporal_distance : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_attribute_relationship : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features_name : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_sr : Optional wkid</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            </span>
<span class="sd">        out_features : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Feature Join&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_target_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_target_features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_target_features</span>
        <span class="k">if</span> <span class="n">in_target_features_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_target_features_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_target_features_layer</span>
        <span class="k">if</span> <span class="n">in_join_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_join_features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_join_features</span>
        <span class="k">if</span> <span class="n">in_join_features_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_join_features_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_join_features_layer</span>
        <span class="k">if</span> <span class="n">in_join_operation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_join_operation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_join_operation</span>
        <span class="k">if</span> <span class="n">in_summary_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_summary_stats&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_summary_stats</span>
        <span class="k">if</span> <span class="n">in_spatial_relationship</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_spatial_relationship&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_spatial_relationship</span>
        <span class="k">if</span> <span class="n">in_spatial_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_spatial_distance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_spatial_distance</span>
        <span class="k">if</span> <span class="n">in_temporal_relationship</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_temporal_relationship&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_temporal_relationship</span>
        <span class="k">if</span> <span class="n">in_temporal_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_temporal_distance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_temporal_distance</span>
        <span class="k">if</span> <span class="n">in_attribute_relationship</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_attribute_relationship&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_attribute_relationship</span>
        <span class="k">if</span> <span class="n">out_features_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;out_features_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_features_name</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;gax:env:outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">job_values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">out_features_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="n">lyr</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">]</span>
            <span class="n">lyr</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;FeatureLayer&quot;</span>
            <span class="n">lyr</span><span class="p">[</span><span class="s">&quot;url&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lyr</span><span class="p">[</span><span class="s">&quot;url&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s">&quot;?token=&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">token</span>
            <span class="k">return</span> <span class="n">lyr</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.create_buffers"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.create_buffers">[docs]</a>    <span class="k">def</span> <span class="nf">create_buffers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_features</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_features_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_buffer_distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_buffer_distance_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_method</span><span class="o">=</span><span class="s">&quot;PLANAR&quot;</span><span class="p">,</span>
                       <span class="n">in_dissolve_type</span><span class="o">=</span><span class="s">&quot;NONE&quot;</span><span class="p">,</span>
                       <span class="n">in_dissolve_fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_summary_stats</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_features_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_features : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_features_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_buffer_distance : Optional LinearUnit</span>
<span class="sd">            </span>
<span class="sd">        in_buffer_distance_field : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_method : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_dissolve_type : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_dissolve_fields : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_summary_stats : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features_name : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Create Buffers&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_features</span>
        <span class="k">if</span> <span class="n">in_features_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_features_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_features_layer</span>
        <span class="k">if</span> <span class="n">in_buffer_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_buffer_distance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_buffer_distance</span>
        <span class="k">if</span> <span class="n">in_buffer_distance_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_buffer_distance_field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_buffer_distance_field</span>
        <span class="k">if</span> <span class="n">in_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_method</span>
        <span class="k">if</span> <span class="n">in_dissolve_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_dissolve_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_dissolve_type</span>
        <span class="k">if</span> <span class="n">in_dissolve_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_dissolve_fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_dissolve_fields</span>
        <span class="k">if</span> <span class="n">in_summary_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_summary_stats&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_summary_stats</span>
        <span class="k">if</span> <span class="n">out_features_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;out_features_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_features_name</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.point_density"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.point_density">[docs]</a>    <span class="k">def</span> <span class="nf">point_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_points</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_points_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_population_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_cell_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_neighborhood</span><span class="o">=</span><span class="s">&quot;Circle&quot;</span><span class="p">,</span>
                       <span class="n">in_neighborhood_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_features_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_points : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_points_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_population_field : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_cell_size : Optional LinearUnit</span>
<span class="sd">            </span>
<span class="sd">        in_neighborhood : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_neighborhood_size : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features_name : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Point Density&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_points&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_points</span>
        <span class="k">if</span> <span class="n">in_points_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_points_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_points_layer</span>
        <span class="k">if</span> <span class="n">in_population_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_population_field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_population_field</span>
        <span class="k">if</span> <span class="n">in_cell_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_cell_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_cell_size</span>
        <span class="k">if</span> <span class="n">in_neighborhood</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_neighborhood&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_neighborhood</span>
        <span class="k">if</span> <span class="n">in_neighborhood_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_neighborhood_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_neighborhood_size</span>
        <span class="k">if</span> <span class="n">out_features_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;out_features_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_features_name</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.create_raster"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.create_raster">[docs]</a>    <span class="k">def</span> <span class="nf">create_raster</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_features</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_features_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_cell_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_features : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_features_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_cell_size : Optional LinearUnit</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_crf : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Create Raster&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_features</span>
        <span class="k">if</span> <span class="n">in_features_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_features_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_features_layer</span>
        <span class="k">if</span> <span class="n">in_cell_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_cell_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_cell_size</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_crf&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_crf&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.extract_data"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.extract_data">[docs]</a>    <span class="k">def</span> <span class="nf">extract_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_features</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_features_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_start_date</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_end_date</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_features_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_features : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_features_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_start_date : Optional datetime.date</span>
<span class="sd">            </span>
<span class="sd">        in_end_date : Optional datetime.date</span>
<span class="sd">            </span>
<span class="sd">        out_features_name : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Extract Data&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_features</span>
        <span class="k">if</span> <span class="n">in_features_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_features_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_features_layer</span>
        <span class="k">if</span> <span class="n">in_start_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_start_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_start_date</span>
        <span class="k">if</span> <span class="n">in_end_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_end_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_end_date</span>
        <span class="k">if</span> <span class="n">out_features_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;out_features_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_features_name</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.reconstruct_tracks"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.reconstruct_tracks">[docs]</a>    <span class="k">def</span> <span class="nf">reconstruct_tracks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_features</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_features_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_track_fields</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_method</span><span class="o">=</span><span class="s">&quot;PLANAR&quot;</span><span class="p">,</span>
                       <span class="n">in_buffer_distance_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_summary_stats</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_distance_split</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_duration_split</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_features</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_features : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_features_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_track_fields : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_method : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_buffer_distance_field : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_summary_stats : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_distance_split : Optional LinearUnit</span>
<span class="sd">            </span>
<span class="sd">        in_duration_split : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_sr : Optional wkid</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            </span>
<span class="sd">        out_features : layer</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Reconstruct Tracks&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_features</span>
        <span class="k">if</span> <span class="n">in_features_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_features_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_features_layer</span>
        <span class="k">if</span> <span class="n">in_track_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_track_fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_track_fields</span>
        <span class="k">if</span> <span class="n">in_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_method</span>
        <span class="k">if</span> <span class="n">in_buffer_distance_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_buffer_distance_field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_buffer_distance_field</span>
        <span class="k">if</span> <span class="n">in_summary_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_summary_stats&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_summary_stats</span>
        <span class="k">if</span> <span class="n">in_distance_split</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_distance_split&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_distance_split</span>
        <span class="k">if</span> <span class="n">in_duration_split</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_duration_split&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_duration_split</span>
        <span class="k">if</span> <span class="n">out_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;out_features_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_features</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">job_values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">out_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="n">lyr</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">]</span>
            
            <span class="n">lyr</span><span class="p">[</span><span class="s">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;FeatureLayer&quot;</span>
            <span class="c">#lyr[&quot;url&quot;] = lyr[&quot;url&quot;] + &quot;?token=&quot; + self.gis._portal.con.token</span>

            <span class="n">flurl</span> <span class="o">=</span> <span class="n">lyr</span><span class="p">[</span><span class="s">&#39;url&#39;</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;FL URL: &quot;</span><span class="o">+</span> <span class="n">flurl</span><span class="p">)</span>
            <span class="n">fsurl</span> <span class="o">=</span> <span class="n">flurl</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;FS URL: &quot;</span> <span class="o">+</span><span class="n">fsurl</span><span class="p">)</span>
            <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
            <span class="p">}</span>

            <span class="n">layerdata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">flurl</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
            
            <span class="n">layer</span> <span class="o">=</span> <span class="n">Layer</span><span class="p">(</span><span class="n">fsurl</span><span class="p">,</span> <span class="n">layerdata</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">layer</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.create_space_time_cube"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.create_space_time_cube">[docs]</a>    <span class="k">def</span> <span class="nf">create_space_time_cube</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_features</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_features_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_bin_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_slice_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_features : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_features_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_bin_size : Optional LinearUnit</span>
<span class="sd">            </span>
<span class="sd">        in_slice_size : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_cube : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Create Space Time Cube&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_features</span>
        <span class="k">if</span> <span class="n">in_features_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_features_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_features_layer</span>
        <span class="k">if</span> <span class="n">in_bin_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_bin_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_bin_size</span>
        <span class="k">if</span> <span class="n">in_slice_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_slice_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_slice_size</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_cube&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_cube&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.sandbox"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.sandbox">[docs]</a>    <span class="k">def</span> <span class="nf">sandbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">command</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">arg</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        command : Optional string</span>
<span class="sd">            </span>
<span class="sd">        arg : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Sandbox&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">command</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;command&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">command</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;arg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>
            <span class="k">return</span> <span class="p">{</span> <span class="p">}</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.create_panel_data"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.create_panel_data">[docs]</a>    <span class="k">def</span> <span class="nf">create_panel_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_target_features</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_target_features_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_join_features</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_join_features_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_summary_stats</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_spatial_relationship</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_spatial_distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_attribute_relationship</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_panel_timestep_interval</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_panel_timestep_repeat</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">in_panel_reference_time</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_features_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_target_features : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_target_features_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_join_features : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_join_features_layer : Optional FeatureSet</span>
<span class="sd">            </span>
<span class="sd">        in_summary_stats : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_spatial_relationship : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_spatial_distance : Optional LinearUnit</span>
<span class="sd">            </span>
<span class="sd">        in_attribute_relationship : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_panel_timestep_interval : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_panel_timestep_repeat : Optional string</span>
<span class="sd">            </span>
<span class="sd">        in_panel_reference_time : Optional datetime.date</span>
<span class="sd">            </span>
<span class="sd">        out_features_name : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_features : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Create Panel Data&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_target_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_target_features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_target_features</span>
        <span class="k">if</span> <span class="n">in_target_features_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_target_features_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_target_features_layer</span>
        <span class="k">if</span> <span class="n">in_join_features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_join_features&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_join_features</span>
        <span class="k">if</span> <span class="n">in_join_features_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_join_features_layer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_join_features_layer</span>
        <span class="k">if</span> <span class="n">in_summary_stats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_summary_stats&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_summary_stats</span>
        <span class="k">if</span> <span class="n">in_spatial_relationship</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_spatial_relationship&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_spatial_relationship</span>
        <span class="k">if</span> <span class="n">in_spatial_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_spatial_distance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_spatial_distance</span>
        <span class="k">if</span> <span class="n">in_attribute_relationship</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_attribute_relationship&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_attribute_relationship</span>
        <span class="k">if</span> <span class="n">in_panel_timestep_interval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_panel_timestep_interval&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_panel_timestep_interval</span>
        <span class="k">if</span> <span class="n">in_panel_timestep_repeat</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_panel_timestep_repeat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_panel_timestep_repeat</span>
        <span class="k">if</span> <span class="n">in_panel_reference_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_panel_reference_time&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_panel_reference_time</span>
        <span class="k">if</span> <span class="n">out_features_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;out_features_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_features_name</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;gax:env:outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_features&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="GeoAnalyticsTools.generate_manifest"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.GeoAnalyticsTools.generate_manifest">[docs]</a>    <span class="k">def</span> <span class="nf">generate_manifest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">in_datastore_folder</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">out_sr</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_datastore_folder : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_sr : Optional string</span>
<span class="sd">            </span>
<span class="sd">        out_manifest_json : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Generate Manifest&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">in_datastore_folder</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;in_datastore_folder&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_datastore_folder</span>
        <span class="k">if</span> <span class="n">out_sr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outSR&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">out_sr</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        
        <span class="n">res</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;out_manifest_json&#39;</span><span class="p">]</span>
        
        <span class="n">manifest_url</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="s">&#39;url&#39;</span><span class="p">]</span>
        <span class="n">manifest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">_portal</span><span class="o">.</span><span class="n">con</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">manifest_url</span><span class="p">)</span>
        <span class="c">#print(&quot;FETCHED&quot; + json.dumps(manifest))</span>
        <span class="k">return</span> <span class="n">manifest</span>
</div></div>
<div class="viewcode-block" id="SpatialAnalysisTools"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools">[docs]</a><span class="k">class</span> <span class="nc">SpatialAnalysisTools</span><span class="p">(</span><span class="n">_AsyncService</span><span class="p">):</span>
    <span class="s">&quot;Represents the SpatialAnalysisTools service. The SpatialAnalysisTools service is used for supporting Spatial analysis capability in Portal for ArcGIS.&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">gis</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a client to the service given it&#39;s url from ArcGIS Online or Portal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">gis</span><span class="p">)</span>
        
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    


<div class="viewcode-block" id="SpatialAnalysisTools.aggregate_points"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.aggregate_points">[docs]</a>    <span class="k">def</span> <span class="nf">aggregate_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">point_layer</span><span class="p">,</span>
                       <span class="n">polygon_layer</span><span class="p">,</span>
                       <span class="n">keep_boundaries_with_no_points</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">summary_fields</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">group_by_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">minority_majority</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">percent_points</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Aggregate points task allows you to aggregate or count the total number of points that are distributed within specified areas or boundaries (polygons). You can also summarize Sum, Mean, Min, Max and Standard deviation calculations for attributes of the point layer to understand the general characteristics of aggregated points. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        point_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            Point layer to be aggregated</span>
<span class="sd">        polygon_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            Polygon layer to which the points should be aggregated.</span>
<span class="sd">        keep_boundaries_with_no_points : Optional bool</span>
<span class="sd">            Specify whether the polygons without any points should be returned in the output.</span>
<span class="sd">        summary_fields : Optional list of strings</span>
<span class="sd">            A list of field names and summary type. Example [fieldName1 summaryType1,fieldName2 summaryType2].</span>
<span class="sd">        group_by_field : Optional string</span>
<span class="sd">            A field name from PointLayer based on which the points will be grouped.</span>
<span class="sd">        minority_majority : Optional bool</span>
<span class="sd">            This boolean parameter is applicable only when a groupByField is specified. If true, the minority (least dominant) or the majority (most dominant) attribute values within each group, within each boundary will be calculated.</span>
<span class="sd">        percent_points : Optional bool</span>
<span class="sd">            This boolean parameter is applicable only when a groupByField is specified. If set to true, the percentage count of points for each unique groupByField value is calculated.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict with the following keys:</span>
<span class="sd">           &quot;aggregated_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;group_summary&quot; : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;AggregatePoints&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;pointLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">point_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;polygonLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">polygon_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">keep_boundaries_with_no_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;keepBoundariesWithNoPoints&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">keep_boundaries_with_no_points</span>
        <span class="k">if</span> <span class="n">summary_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;summaryFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">summary_fields</span>
        <span class="k">if</span> <span class="n">group_by_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;groupByField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_by_field</span>
        <span class="k">if</span> <span class="n">minority_majority</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;minorityMajority&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minority_majority</span>
        <span class="k">if</span> <span class="n">percent_points</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;percentPoints&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">percent_points</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;aggregatedLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            
            <span class="n">aggregated_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;aggregatedLayer&#39;</span><span class="p">])</span>

            <span class="n">group_summary</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;groupSummary&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;aggregated_layer&quot;</span><span class="p">:</span><span class="n">aggregated_layer</span><span class="p">,</span> <span class="s">&quot;group_summary&quot;</span><span class="p">:</span><span class="n">group_summary</span><span class="p">,</span> <span class="p">}</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.find_hot_spots"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.find_hot_spots">[docs]</a>    <span class="k">def</span> <span class="nf">find_hot_spots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">analysis_layer</span><span class="p">,</span>
                       <span class="n">analysis_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">divided_by_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">bounding_polygon_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">aggregation_polygon_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Find Hot Spots task finds statistically significant clusters of incident points, weighted points, or weighted polygons. For incident data, the analysis field (weight) is obtained by aggregation. Output is a hot spot map.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        analysis_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The point or polygon feature layer for which hot spots will be calculated.</span>
<span class="sd">        analysis_field : Optional string</span>
<span class="sd">            The numeric field in the AnalysisLayer that will be analyzed. </span>
<span class="sd">        divided_by_field : Optional string</span>
<span class="sd">            </span>
<span class="sd">        bounding_polygon_layer : Optional layer (see Feature Input in documentation)</span>
<span class="sd">            When the analysis layer is points and no AnalysisField is specified, you can provide polygons features that define where incidents could have occurred.</span>
<span class="sd">        aggregation_polygon_layer : Optional layer (see Feature Input in documentation)</span>
<span class="sd">            When the AnalysisLayer contains points and no AnalysisField is specified, you can provide polygon features into which the points will be aggregated and analyzed, such as administrative units.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict with the following keys:</span>
<span class="sd">           &quot;hot_spots_result_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;process_info&quot; : list of messages</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;FindHotSpots&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;analysisLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">analysis_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">analysis_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;analysisField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis_field</span>
        <span class="k">if</span> <span class="n">divided_by_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;dividedByField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">divided_by_field</span>
        <span class="k">if</span> <span class="n">bounding_polygon_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;boundingPolygonLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">bounding_polygon_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">aggregation_polygon_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;aggregationPolygonLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">aggregation_polygon_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;hotSpotsResultLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            
            <span class="n">hot_spots_result_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;hotSpotsResultLayer&#39;</span><span class="p">])</span>

            <span class="n">process_info</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;processInfo&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;hot_spots_result_layer&quot;</span><span class="p">:</span><span class="n">hot_spots_result_layer</span><span class="p">,</span> <span class="s">&quot;process_info&quot;</span><span class="p">:</span><span class="n">process_info</span><span class="p">,</span> <span class="p">}</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.create_buffers"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.create_buffers">[docs]</a>    <span class="k">def</span> <span class="nf">create_buffers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">distances</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">units</span><span class="o">=</span><span class="s">&quot;Meters&quot;</span><span class="p">,</span>
                       <span class="n">dissolve_type</span><span class="o">=</span><span class="s">&quot;None&quot;</span><span class="p">,</span>
                       <span class="n">ring_type</span><span class="o">=</span><span class="s">&quot;Disks&quot;</span><span class="p">,</span>
                       <span class="n">side_type</span><span class="o">=</span><span class="s">&quot;Full&quot;</span><span class="p">,</span>
                       <span class="n">end_type</span><span class="o">=</span><span class="s">&quot;Round&quot;</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates buffer polygon(s) around input features.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The input to be buffered.</span>
<span class="sd">        distances : Optional list of floats</span>
<span class="sd">            The distance(s) that will be buffered.</span>
<span class="sd">        field : Optional string</span>
<span class="sd">            Buffers will be created using field values.</span>
<span class="sd">        units : Optional string</span>
<span class="sd">            The linear unit to be used with the distance value(s).</span>
<span class="sd">        dissolve_type : Optional string</span>
<span class="sd">            Specifies the dissolve to be performed to remove buffer overlap.</span>
<span class="sd">        ring_type : Optional string</span>
<span class="sd">            The ring type.</span>
<span class="sd">        side_type : Optional string</span>
<span class="sd">            The side(s) of the input that will be buffered.</span>
<span class="sd">        end_type : Optional string</span>
<span class="sd">            The shape of the buffer at the end of buffered line features.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        buffer_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;CreateBuffers&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">distances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;distances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">distances</span>
        <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">units</span>
        <span class="k">if</span> <span class="n">dissolve_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;dissolveType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dissolve_type</span>
        <span class="k">if</span> <span class="n">ring_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;ringType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ring_type</span>
        <span class="k">if</span> <span class="n">side_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;sideType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">side_type</span>
        <span class="k">if</span> <span class="n">end_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;endType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_type</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;bufferLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;bufferLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.create_drive_time_areas"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.create_drive_time_areas">[docs]</a>    <span class="k">def</span> <span class="nf">create_drive_time_areas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">break_values</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
                       <span class="n">break_units</span><span class="o">=</span><span class="s">&quot;Minutes&quot;</span><span class="p">,</span>
                       <span class="n">travel_mode</span><span class="o">=</span><span class="s">&quot;Driving&quot;</span><span class="p">,</span>
                       <span class="n">overlap_policy</span><span class="o">=</span><span class="s">&quot;Overlap&quot;</span><span class="p">,</span>
                       <span class="n">time_of_day</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">time_zone_for_time_of_day</span><span class="o">=</span><span class="s">&quot;GeoLocal&quot;</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        break_values : Optional list of floats</span>
<span class="sd">            </span>
<span class="sd">        break_units : Optional string</span>
<span class="sd">            </span>
<span class="sd">        travel_mode : Optional string</span>
<span class="sd">            </span>
<span class="sd">        overlap_policy : Optional string</span>
<span class="sd">            </span>
<span class="sd">        time_of_day : Optional datetime.date</span>
<span class="sd">            </span>
<span class="sd">        time_zone_for_time_of_day : Optional string</span>
<span class="sd">            </span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        drive_time_areas_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;CreateDriveTimeAreas&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">break_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;breakValues&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">break_values</span>
        <span class="k">if</span> <span class="n">break_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;breakUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">break_units</span>
        <span class="k">if</span> <span class="n">travel_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;travelMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">travel_mode</span>
        <span class="k">if</span> <span class="n">overlap_policy</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;overlapPolicy&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">overlap_policy</span>
        <span class="k">if</span> <span class="n">time_of_day</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;timeOfDay&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_of_day</span>
        <span class="k">if</span> <span class="n">time_zone_for_time_of_day</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;timeZoneForTimeOfDay&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_zone_for_time_of_day</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;driveTimeAreasLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;driveTimeAreasLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.dissolve_boundaries"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.dissolve_boundaries">[docs]</a>    <span class="k">def</span> <span class="nf">dissolve_boundaries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">dissolve_fields</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">summary_fields</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Dissolve features based on specified fields.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The layer containing polygon features that will be dissolved.</span>
<span class="sd">        dissolve_fields : Optional list of strings</span>
<span class="sd">            One or more fields from the input that control which polygons are merged. If no fields are supplied, all polygons that overlap or shared a common border will be dissolved into one polygon.</span>
<span class="sd">        summary_fields : Optional list of strings</span>
<span class="sd">            A list of field names and statistical types that will be used to summarize the output. Supported statistics include: Sum, Mean, Min, Max, and Stddev.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dissolved_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;DissolveBoundaries&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dissolve_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;dissolveFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dissolve_fields</span>
        <span class="k">if</span> <span class="n">summary_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;summaryFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">summary_fields</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;dissolvedLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;dissolvedLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.merge_layers"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.merge_layers">[docs]</a>    <span class="k">def</span> <span class="nf">merge_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">merge_layer</span><span class="p">,</span>
                       <span class="n">merging_attributes</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Combines two inputs of the same feature data type into a new output.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">             The point, line, or polygon  features to merge with the mergeLayer.</span>
<span class="sd">        merge_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The point, line or polygon features to merge with inputLayer.  mergeLayer must contain the same feature type (point, line, or polygon) as the inputLayer.</span>
<span class="sd">        merging_attributes : Optional list of strings</span>
<span class="sd">            An array of values that describe how fields from the mergeLayer are to be modified.  By default all fields from both inputs will be carried across to the output.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        merged_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;MergeLayers&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;mergeLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">merge_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">merging_attributes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;mergingAttributes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merging_attributes</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;mergedLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;mergedLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.summarize_within"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.summarize_within">[docs]</a>    <span class="k">def</span> <span class="nf">summarize_within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">sum_within_layer</span><span class="p">,</span>
                       <span class="n">summary_layer</span><span class="p">,</span>
                       <span class="n">sum_shape</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">shape_units</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">summary_fields</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">group_by_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">minority_majority</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">percent_shape</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The SummarizeWithin task helps you to summarize and find statistics on the point, line, or polygon features (or portions of these features) that are within the boundaries of polygons in another layer. For example:Given a layer of watershed boundaries and a layer of land-use boundaries by land-use type, calculate total acreage of land-use type for each watershed.Given a layer of parcels in a county and a layer of city boundaries, summarize the average value of vacant parcels within each city boundary.Given a layer of counties and a layer of roads, summarize the total mileage of roads by road type within each county.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sum_within_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            A polygon feature layer or featurecollection. Features, or portions of features, in the summaryLayer (below) that fall within the boundaries of these polygons will be summarized.</span>
<span class="sd">        summary_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            Point, line, or polygon features that will be summarized for each polygon in the sumWithinLayer.</span>
<span class="sd">        sum_shape : Optional bool</span>
<span class="sd">            A boolean value that instructs the task to calculate count of points, length of lines or areas of polygons of the summaryLayer within each polygon in sumWithinLayer.</span>
<span class="sd">        shape_units : Optional string</span>
<span class="sd">            Specify units to summarize the length or areas when sumShape is set to true. Units is not required to summarize points.</span>
<span class="sd">        summary_fields : Optional list of strings</span>
<span class="sd">            A list of field names and statistical summary type that you wish to calculate for all features in the  summaryLayer that are within each polygon in the sumWithinLayer . Eg: [&quot;fieldname1 summary&quot;, &quot;fieldname2 summary&quot;]</span>
<span class="sd">        group_by_field : Optional string</span>
<span class="sd">            Specify a field from the summaryLayer features to calculate statistics separately for each unique attribute value.</span>
<span class="sd">        minority_majority : Optional bool</span>
<span class="sd">            This boolean parameter is applicable only when a groupByField is specified. If true, the minority (least dominant) or the majority (most dominant) attribute values within each group, within each boundary will be calculated. </span>
<span class="sd">        percent_shape : Optional bool</span>
<span class="sd">            This boolean parameter is applicable only when a groupByField is specified. If set to true, the percentage of shape (eg. length for lines) for each unique groupByField value is calculated.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict with the following keys:</span>
<span class="sd">           &quot;result_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;group_by_summary&quot; : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;SummarizeWithin&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;sumWithinLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">sum_within_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;summaryLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">summary_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sum_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;sumShape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum_shape</span>
        <span class="k">if</span> <span class="n">shape_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;shapeUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shape_units</span>
        <span class="k">if</span> <span class="n">summary_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;summaryFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">summary_fields</span>
        <span class="k">if</span> <span class="n">group_by_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;groupByField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_by_field</span>
        <span class="k">if</span> <span class="n">minority_majority</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;minorityMajority&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minority_majority</span>
        <span class="k">if</span> <span class="n">percent_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;percentShape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">percent_shape</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            
            <span class="n">result_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">])</span>

            <span class="n">group_by_summary</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;groupBySummary&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;result_layer&quot;</span><span class="p">:</span><span class="n">result_layer</span><span class="p">,</span> <span class="s">&quot;group_by_summary&quot;</span><span class="p">:</span><span class="n">group_by_summary</span><span class="p">,</span> <span class="p">}</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.enrich_layer"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.enrich_layer">[docs]</a>    <span class="k">def</span> <span class="nf">enrich_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">data_collections</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">analysis_variables</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">country</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">buffer_type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">units</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Enrich Layer task enriches your data by getting facts about the people, places, and businesses that surround your data locations. For example: What kind of people live here? What do people like to do in this area? What are their habits and lifestyles? What kind of businesses are there in this area?The result will be a new layer of input features that includes all demographic and geographic information from given data collections. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            Feature layer to enrich with new data</span>
<span class="sd">        data_collections : Optional list of strings</span>
<span class="sd">            Data collections you wish to add to your features.</span>
<span class="sd">        analysis_variables : Optional list of strings</span>
<span class="sd">            A subset of specific variables instead of dataCollections.</span>
<span class="sd">        country : Optional string</span>
<span class="sd">            The two character country code that specifies the country of the input features. Eg. US (United States),  FR (France), GB (United Kingdom) etc.</span>
<span class="sd">        buffer_type : Optional string</span>
<span class="sd">            Area to be created around the point or line features for enrichment. Default is 1 Mile straight-line buffer radius.</span>
<span class="sd">        distance : Optional float</span>
<span class="sd">            A double value that defines the straight-line distance or time (when drivingTime is used).</span>
<span class="sd">        units : Optional string</span>
<span class="sd">            The unit (eg. Miles, Minutes) to be used with the distance value(s) specified in the distance parameter to calculate the area.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        enriched_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;EnrichLayer&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data_collections</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;dataCollections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_collections</span>
        <span class="k">if</span> <span class="n">analysis_variables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;analysisVariables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis_variables</span>
        <span class="k">if</span> <span class="n">country</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;country&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country</span>
        <span class="k">if</span> <span class="n">buffer_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;bufferType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">buffer_type</span>
        <span class="k">if</span> <span class="n">distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;distance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">distance</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">units</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;enrichedLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;enrichedLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.overlay_layers"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.overlay_layers">[docs]</a>    <span class="k">def</span> <span class="nf">overlay_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">overlay_layer</span><span class="p">,</span>
                       <span class="n">overlay_type</span><span class="o">=</span><span class="s">&quot;Intersect&quot;</span><span class="p">,</span>
                       <span class="n">snap_to_input</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">output_type</span><span class="o">=</span><span class="s">&quot;Input&quot;</span><span class="p">,</span>
                       <span class="n">tolerance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Overlays the input layer with the overlay layer. Overlay operations supported are Intersect, Union, and Erase.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The input analysis layer.</span>
<span class="sd">        overlay_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The layer to be overlaid with the analysis layer.</span>
<span class="sd">        overlay_type : Optional string</span>
<span class="sd">            The overlay type (INTERSECT, UNION, or ERASE) defines how the analysis layer and the overlay layer are combined.</span>
<span class="sd">        snap_to_input : Optional bool</span>
<span class="sd">            When the distance between features is less than the tolerance, the features in the overlay layer will snap to the features in the input layer.</span>
<span class="sd">        output_type : Optional string</span>
<span class="sd">            The type of intersection (INPUT, LINE, POINT).</span>
<span class="sd">        tolerance : Optional float</span>
<span class="sd">            The minimum distance separating all feature coordinates (nodes and vertices) as well as the distance a coordinate can move in X or Y (or both). </span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        output_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;OverlayLayers&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;overlayLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">overlay_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">overlay_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;overlayType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">overlay_type</span>
        <span class="k">if</span> <span class="n">snap_to_input</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;snapToInput&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">snap_to_input</span>
        <span class="k">if</span> <span class="n">output_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_type</span>
        <span class="k">if</span> <span class="n">tolerance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;tolerance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tolerance</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;outputLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;outputLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.extract_data"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.extract_data">[docs]</a>    <span class="k">def</span> <span class="nf">extract_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layers</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">extent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">clip</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">data_format</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Select and download data for a specified area of interest. Layers that you select will be added to a zip file or layer package. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layers : Required list of strings</span>
<span class="sd">            The layers from which you can extract features. </span>
<span class="sd">        extent : Optional string</span>
<span class="sd">            The area that defines which features will be included in the output zip file or layer package.   </span>
<span class="sd">        clip : Optional bool</span>
<span class="sd">            Select features that intersect the extent or clip features within the extent.</span>
<span class="sd">        data_format : Optional string</span>
<span class="sd">            Format of the data that will be extracted and downloaded.  Layer packages will always include file geodatabases.&amp;lt;/p&amp;gt;</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        content_id : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;ExtractData&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_layers</span>
        <span class="k">if</span> <span class="n">extent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;extent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">extent</span>
        <span class="k">if</span> <span class="n">clip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;clip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clip</span>
        <span class="k">if</span> <span class="n">data_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;dataFormat&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_format</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;contentID&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;contentID&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.find_existing_locations"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.find_existing_locations">[docs]</a>    <span class="k">def</span> <span class="nf">find_existing_locations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layers</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">expressions</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Find Existing Locations task selects features in the input layer that meet a query you specify. A query is made up of one or more expressions. There are two types of expressions: attribute and spatial. An example of an attribute expression is that a parcel must be vacant, which is an attribute of the Parcels layer (where STATUS = &#39;VACANT&#39;). An example of a spatial expression is that the parcel must also be within a certain distance of a river (Parcels within a distance of 0.75 Miles from Rivers).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layers : Required list of strings</span>
<span class="sd">            A list of layers that will be used in the expressions parameter.</span>
<span class="sd">        expressions : Required string</span>
<span class="sd">            Specify a list of expressions. Please refer documentation at http://developers.arcgis.com for more information on creating expressions.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;FindExistingLocations&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_layers</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;expressions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">expressions</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.derive_new_locations"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.derive_new_locations">[docs]</a>    <span class="k">def</span> <span class="nf">derive_new_locations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layers</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">expressions</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Derive New Locations task derives new features from the input layers that meet a query you specify. A query is made up of one or more expressions. There are two types of expressions: attribute and spatial. An example of an attribute expression is that a parcel must be vacant, which is an attribute of the Parcels layer (where STATUS = &#39;VACANT&#39;). An example of a spatial expression is that the parcel must also be within a certain distance of a river (Parcels within a distance of 0.75 Miles from Rivers).The Derive New Locations task is very similar to the Find Existing Locations task, the main difference is that the result of Derive New Locations can contain partial features.In both tasks, the attribute expression  where and the spatial relationships within and contains return the same result. This is because these relationships return entire features.When intersects or withinDistance is used, Derive New Locations creates new features in the result. For example, when intersecting a parcel feature and a flood zone area that partially overlap each other, Find Existing Locations will return the entire parcel whereas Derive New Locations will return just the portion of the parcel that is within the flood zone.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layers : Required list of strings</span>
<span class="sd">            A list of layers that will be used in the expressions parameter.</span>
<span class="sd">        expressions : Required string</span>
<span class="sd">            Specify a list of expressions. Please refer documentation at http://developers.arcgis.com for more information on expressions.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;DeriveNewLocations&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_layers</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;expressions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">expressions</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.field_calculator"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.field_calculator">[docs]</a>    <span class="k">def</span> <span class="nf">field_calculator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">expressions</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates existing fields or creates and calculates new fields.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        expressions : Required string</span>
<span class="sd">            </span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            </span>
<span class="sd">        context : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;FieldCalculator&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;expressions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">expressions</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.interpolate_points"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.interpolate_points">[docs]</a>    <span class="k">def</span> <span class="nf">interpolate_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">field</span><span class="p">,</span>
                       <span class="n">interpolate_option</span><span class="o">=</span><span class="s">&quot;5&quot;</span><span class="p">,</span>
                       <span class="n">output_prediction_error</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">classification_type</span><span class="o">=</span><span class="s">&quot;GeometricInterval&quot;</span><span class="p">,</span>
                       <span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                       <span class="n">class_breaks</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">bounding_polygon_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">predict_at_point_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Interpolate Points task allows you to predict values at new locations based on measurements from a collection of points. The task takes point data with values at each point and returns areas classified by predicted values. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The point layer whose features will be interpolated.</span>
<span class="sd">        field : Required string</span>
<span class="sd">            Name of the numeric field containing the values you wish to interpolate.</span>
<span class="sd">        interpolate_option : Optional string</span>
<span class="sd">            Integer value declaring your preference for speed versus accuracy, from 1 (fastest) to 9 (most accurate). More accurate predictions take longer to calculate.</span>
<span class="sd">        output_prediction_error : Optional bool</span>
<span class="sd">            If True, a polygon layer of standard errors for the interpolation predictions will be returned in the predictionError output parameter.</span>
<span class="sd">        classification_type : Optional string</span>
<span class="sd">            Determines how predicted values will be classified into areas.</span>
<span class="sd">        num_classes : Optional int</span>
<span class="sd">            This value is used to divide the range of interpolated values into distinct classes. The range of values in each class is determined by the classificationType parameter. Each class defines the boundaries of the result polygons.</span>
<span class="sd">        class_breaks : Optional list of floats</span>
<span class="sd">            If classificationType is Manual, supply desired class break values separated by spaces. These values define the upper limit of each class, so the number of classes will equal the number of entered values. Areas will not be created for any locations with predicted values above the largest entered break value. You must enter at least two values and no more than 32.</span>
<span class="sd">        bounding_polygon_layer : Optional layer (see Feature Input in documentation)</span>
<span class="sd">            A layer specifying the polygon(s) where you want values to be interpolated.</span>
<span class="sd">        predict_at_point_layer : Optional layer (see Feature Input in documentation)</span>
<span class="sd">            An optional layer specifying point locations to calculate prediction values. This allows you to make predictions at specific locations of interest. </span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict with the following keys:</span>
<span class="sd">           &quot;result_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;prediction_error&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;predicted_point_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;InterpolatePoints&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span>
        <span class="k">if</span> <span class="n">interpolate_option</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;interpolateOption&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_option</span>
        <span class="k">if</span> <span class="n">output_prediction_error</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputPredictionError&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_prediction_error</span>
        <span class="k">if</span> <span class="n">classification_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;classificationType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">classification_type</span>
        <span class="k">if</span> <span class="n">num_classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;numClasses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_classes</span>
        <span class="k">if</span> <span class="n">class_breaks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;classBreaks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">class_breaks</span>
        <span class="k">if</span> <span class="n">bounding_polygon_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;boundingPolygonLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">bounding_polygon_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">predict_at_point_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;predictAtPointLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">predict_at_point_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            
            <span class="n">result_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">])</span>

            <span class="n">prediction_error</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;predictionError&#39;</span><span class="p">])</span>

            <span class="n">predicted_point_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;predictedPointLayer&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;result_layer&quot;</span><span class="p">:</span><span class="n">result_layer</span><span class="p">,</span> <span class="s">&quot;prediction_error&quot;</span><span class="p">:</span><span class="n">prediction_error</span><span class="p">,</span> <span class="s">&quot;predicted_point_layer&quot;</span><span class="p">:</span><span class="n">predicted_point_layer</span><span class="p">,</span> <span class="p">}</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.calculate_density"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.calculate_density">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">cell_size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">cell_size_units</span><span class="o">=</span><span class="s">&quot;Meters&quot;</span><span class="p">,</span>
                       <span class="n">radius</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">radius_units</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">bounding_polygon_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">area_units</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">classification_type</span><span class="o">=</span><span class="s">&quot;EqualInterval&quot;</span><span class="p">,</span>
                       <span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The Calculate Density task creates a density map from point or line features by spreading known quantities of some phenomenon (represented as attributes of the points or lines) across the map. The result is a layer of areas classified from least dense to most dense.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The point or line features from which to calculate density.</span>
<span class="sd">        field : Optional string</span>
<span class="sd">            A numeric field name specifying the number of incidents at each location. If not specified, each location will be assumed to represent a single count.</span>
<span class="sd">        cell_size : Optional float</span>
<span class="sd">            This value is used to create a mesh of points where density values are calculated. The default is approximately 1/1000th of the smaller of the width and height of the analysis extent as defined in the context parameter.</span>
<span class="sd">        cell_size_units : Optional string</span>
<span class="sd">            The units of the cellSize value</span>
<span class="sd">        radius : Optional float</span>
<span class="sd">            A distance specifying how far to search to find point or line features when calculating density values.</span>
<span class="sd">        radius_units : Optional string</span>
<span class="sd">            The units of the radius parameter. </span>
<span class="sd">        bounding_polygon_layer : Optional layer (see Feature Input in documentation)</span>
<span class="sd">            A layer specifying the polygon(s) where you want densities to be calculated.</span>
<span class="sd">        area_units : Optional string</span>
<span class="sd">            The units of the calculated density values.</span>
<span class="sd">        classification_type : Optional string</span>
<span class="sd">            Determines how density values will be classified into polygons.</span>
<span class="sd">        num_classes : Optional int</span>
<span class="sd">            This value is used to divide the range of predicted values into distinct classes. The range of values in each class is determined by the classificationType parameter.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        result_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;CalculateDensity&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span>
        <span class="k">if</span> <span class="n">cell_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;cellSize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell_size</span>
        <span class="k">if</span> <span class="n">cell_size_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;cellSizeUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cell_size_units</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="k">if</span> <span class="n">radius_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;radiusUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius_units</span>
        <span class="k">if</span> <span class="n">bounding_polygon_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;boundingPolygonLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">bounding_polygon_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">area_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;areaUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">area_units</span>
        <span class="k">if</span> <span class="n">classification_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;classificationType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">classification_type</span>
        <span class="k">if</span> <span class="n">num_classes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;numClasses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_classes</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.summarize_nearby"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.summarize_nearby">[docs]</a>    <span class="k">def</span> <span class="nf">summarize_nearby</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">sum_nearby_layer</span><span class="p">,</span>
                       <span class="n">summary_layer</span><span class="p">,</span>
                       <span class="n">near_type</span><span class="o">=</span><span class="s">&quot;StraightLine&quot;</span><span class="p">,</span>
                       <span class="n">distances</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">units</span><span class="o">=</span><span class="s">&quot;Meters&quot;</span><span class="p">,</span>
                       <span class="n">time_of_day</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">time_zone_for_time_of_day</span><span class="o">=</span><span class="s">&quot;GeoLocal&quot;</span><span class="p">,</span>
                       <span class="n">return_boundaries</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">sum_shape</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">shape_units</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">summary_fields</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">group_by_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">minority_majority</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">percent_shape</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The SummarizeNearby task finds features that are within a specified distance of features in the input layer. Distance can be measured as a straight-line distance, a drive-time distance (for example, within 10 minutes), or a drive distance (within 5 kilometers). Statistics are then calculated for the nearby features. For example:Calculate the total population within five minutes of driving time of a proposed new store location.Calculate the number of freeway access ramps within a one-mile driving distance of a proposed new store location to use as a measure of store accessibility.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sum_nearby_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            Point, line, or polygon features from which distances will be measured to features in the summarizeLayer.</span>
<span class="sd">        summary_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            Point, line, or polygon features. Features in this layer that are within the specified distance to features in the sumNearbyLayer will be summarized.</span>
<span class="sd">        near_type : Optional string</span>
<span class="sd">            Defines what kind of distance measurement you want to use to create areas around the nearbyLayer features. </span>
<span class="sd">        distances : Required list of floats</span>
<span class="sd">            An array of double values that defines the search distance for creating areas mentioned above</span>
<span class="sd">        units : Optional string</span>
<span class="sd">            The linear unit for distances parameter above. Eg. Miles, Kilometers, Minutes Seconds etc</span>
<span class="sd">        time_of_day : Optional datetime.date</span>
<span class="sd">            For timeOfDay, set the time and day according to the number of milliseconds elapsed since the Unix epoc (January 1, 1970 UTC). When specified and if relevant for the nearType parameter, the traffic conditions during the time of the day will be considered.</span>
<span class="sd">        time_zone_for_time_of_day : Optional string</span>
<span class="sd">            Determines if the value specified for timeOfDay is specified in UTC or in a time zone that is local to the location of the origins. </span>
<span class="sd">        return_boundaries : Optional bool</span>
<span class="sd">            If true, will return a result layer of areas that contain the requested summary information.  The resulting areas are defined by the specified nearType.  For example, if using a StraightLine of 5 miles, your result will contain areas with a 5 mile radius around the input features and specified summary information.If false, the resulting layer will return the same features as the input analysis layer with requested summary information. </span>
<span class="sd">        sum_shape : Optional bool</span>
<span class="sd">            A boolean value that instructs the task to calculate count of points, length of lines or areas of polygons of the summaryLayer within each polygon in sumWithinLayer.</span>
<span class="sd">        shape_units : Optional string</span>
<span class="sd">            Specify units to summarize the length or areas when sumShape is set to true. Units is not required to summarize points.</span>
<span class="sd">        summary_fields : Optional list of strings</span>
<span class="sd">            A list of field names and statistical summary type that you wish to calculate for all features in the summaryLayer that are within each polygon in the sumWithinLayer . Eg: [&quot;fieldname1 summary&quot;, &quot;fieldname2 summary&quot;]</span>
<span class="sd">        group_by_field : Optional string</span>
<span class="sd">            Specify a field from the summaryLayer features to calculate statistics separately for each unique value of the field.</span>
<span class="sd">        minority_majority : Optional bool</span>
<span class="sd">            This boolean parameter is applicable only when a groupByField is specified. If true, the minority (least dominant) or the majority (most dominant) attribute values within each group, within each boundary will be calculated.</span>
<span class="sd">        percent_shape : Optional bool</span>
<span class="sd">            This boolean parameter is applicable only when a groupByField is specified. If set to true, the percentage of shape (eg. length for lines) for each unique groupByField value is calculated.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict with the following keys:</span>
<span class="sd">           &quot;result_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;group_by_summary&quot; : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;SummarizeNearby&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;sumNearbyLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">sum_nearby_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;summaryLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">summary_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">near_type</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;nearType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">near_type</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;distances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">distances</span>
        <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">units</span>
        <span class="k">if</span> <span class="n">time_of_day</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;timeOfDay&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_of_day</span>
        <span class="k">if</span> <span class="n">time_zone_for_time_of_day</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;timeZoneForTimeOfDay&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_zone_for_time_of_day</span>
        <span class="k">if</span> <span class="n">return_boundaries</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;returnBoundaries&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">return_boundaries</span>
        <span class="k">if</span> <span class="n">sum_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;sumShape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum_shape</span>
        <span class="k">if</span> <span class="n">shape_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;shapeUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">shape_units</span>
        <span class="k">if</span> <span class="n">summary_fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;summaryFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">summary_fields</span>
        <span class="k">if</span> <span class="n">group_by_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;groupByField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_by_field</span>
        <span class="k">if</span> <span class="n">minority_majority</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;minorityMajority&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minority_majority</span>
        <span class="k">if</span> <span class="n">percent_shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;percentShape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">percent_shape</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            
            <span class="n">result_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;resultLayer&#39;</span><span class="p">])</span>

            <span class="n">group_by_summary</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;groupBySummary&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;result_layer&quot;</span><span class="p">:</span><span class="n">result_layer</span><span class="p">,</span> <span class="s">&quot;group_by_summary&quot;</span><span class="p">:</span><span class="n">group_by_summary</span><span class="p">,</span> <span class="p">}</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.create_viewshed"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.create_viewshed">[docs]</a>    <span class="k">def</span> <span class="nf">create_viewshed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">dem_resolution</span><span class="o">=</span><span class="s">&quot;Finest&quot;</span><span class="p">,</span>
                       <span class="n">maximum_distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">max_distance_units</span><span class="o">=</span><span class="s">&quot;Meters&quot;</span><span class="p">,</span>
                       <span class="n">observer_height</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">observer_height_units</span><span class="o">=</span><span class="s">&quot;Meters&quot;</span><span class="p">,</span>
                       <span class="n">target_height</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">target_height_units</span><span class="o">=</span><span class="s">&quot;Meters&quot;</span><span class="p">,</span>
                       <span class="n">generalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        dem_resolution : Optional string</span>
<span class="sd">            </span>
<span class="sd">        maximum_distance : Optional float</span>
<span class="sd">            </span>
<span class="sd">        max_distance_units : Optional string</span>
<span class="sd">            </span>
<span class="sd">        observer_height : Optional float</span>
<span class="sd">            </span>
<span class="sd">        observer_height_units : Optional string</span>
<span class="sd">            </span>
<span class="sd">        target_height : Optional float</span>
<span class="sd">            </span>
<span class="sd">        target_height_units : Optional string</span>
<span class="sd">            </span>
<span class="sd">        generalize : Optional bool</span>
<span class="sd">            </span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            </span>
<span class="sd">        context : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        viewshed_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;CreateViewshed&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dem_resolution</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;demResolution&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dem_resolution</span>
        <span class="k">if</span> <span class="n">maximum_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;maximumDistance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maximum_distance</span>
        <span class="k">if</span> <span class="n">max_distance_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;maxDistanceUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_distance_units</span>
        <span class="k">if</span> <span class="n">observer_height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;observerHeight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">observer_height</span>
        <span class="k">if</span> <span class="n">observer_height_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;observerHeightUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">observer_height_units</span>
        <span class="k">if</span> <span class="n">target_height</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;targetHeight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">target_height</span>
        <span class="k">if</span> <span class="n">target_height_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;targetHeightUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">target_height_units</span>
        <span class="k">if</span> <span class="n">generalize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;generalize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">generalize</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;viewshedLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;viewshedLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.find_similar_locations"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.find_similar_locations">[docs]</a>    <span class="k">def</span> <span class="nf">find_similar_locations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">search_layer</span><span class="p">,</span>
                       <span class="n">analysis_fields</span><span class="o">=</span><span class="p">[],</span>
                       <span class="n">input_query</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">number_of_results</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        search_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        analysis_fields : Required list of strings</span>
<span class="sd">            </span>
<span class="sd">        input_query : Optional string</span>
<span class="sd">            </span>
<span class="sd">        number_of_results : Optional int</span>
<span class="sd">            </span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            </span>
<span class="sd">        context : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict with the following keys:</span>
<span class="sd">           &quot;similar_result_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;process_info&quot; : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;FindSimilarLocations&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;searchLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">search_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;analysisFields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis_fields</span>
        <span class="k">if</span> <span class="n">input_query</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputQuery&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_query</span>
        <span class="k">if</span> <span class="n">number_of_results</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;numberOfResults&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">number_of_results</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;similarResultLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            
            <span class="n">similar_result_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;similarResultLayer&#39;</span><span class="p">])</span>

            <span class="n">process_info</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;processInfo&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;similar_result_layer&quot;</span><span class="p">:</span><span class="n">similar_result_layer</span><span class="p">,</span> <span class="s">&quot;process_info&quot;</span><span class="p">:</span><span class="n">process_info</span><span class="p">,</span> <span class="p">}</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.create_watersheds"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.create_watersheds">[docs]</a>    <span class="k">def</span> <span class="nf">create_watersheds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">search_distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">search_units</span><span class="o">=</span><span class="s">&quot;Meters&quot;</span><span class="p">,</span>
                       <span class="n">source_database</span><span class="o">=</span><span class="s">&quot;FINEST&quot;</span><span class="p">,</span>
                       <span class="n">generalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        search_distance : Optional float</span>
<span class="sd">            </span>
<span class="sd">        search_units : Optional string</span>
<span class="sd">            </span>
<span class="sd">        source_database : Optional string</span>
<span class="sd">            </span>
<span class="sd">        generalize : Optional bool</span>
<span class="sd">            </span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            </span>
<span class="sd">        context : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict with the following keys:</span>
<span class="sd">           &quot;snap_pour_pts_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;watershed_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;CreateWatersheds&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">search_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;searchDistance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">search_distance</span>
        <span class="k">if</span> <span class="n">search_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;searchUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">search_units</span>
        <span class="k">if</span> <span class="n">source_database</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;sourceDatabase&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_database</span>
        <span class="k">if</span> <span class="n">generalize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;generalize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">generalize</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;snapPourPtsLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            
            <span class="n">snap_pour_pts_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;snapPourPtsLayer&#39;</span><span class="p">])</span>

            <span class="n">watershed_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;watershedLayer&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;snap_pour_pts_layer&quot;</span><span class="p">:</span><span class="n">snap_pour_pts_layer</span><span class="p">,</span> <span class="s">&quot;watershed_layer&quot;</span><span class="p">:</span><span class="n">watershed_layer</span><span class="p">,</span> <span class="p">}</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.find_nearest"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.find_nearest">[docs]</a>    <span class="k">def</span> <span class="nf">find_nearest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">analysis_layer</span><span class="p">,</span>
                       <span class="n">near_layer</span><span class="p">,</span>
                       <span class="n">measurement_type</span><span class="o">=</span><span class="s">&quot;StraightLine&quot;</span><span class="p">,</span>
                       <span class="n">max_count</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                       <span class="n">search_cutoff</span><span class="o">=</span><span class="mi">2147483647</span><span class="p">,</span>
                       <span class="n">search_cutoff_units</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">time_of_day</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">time_zone_for_time_of_day</span><span class="o">=</span><span class="s">&quot;GeoLocal&quot;</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Measures the straight-line distance, driving distance, or driving time from features in the analysis layer to features in the near layer, and copies the nearest features in the near layer to a new layer. Returns a layer containing the nearest features and a line layer that links the start locations to their nearest locations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        analysis_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            For each feature in this layer, the task finds the nearest features from the nearLayer.</span>
<span class="sd">        near_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The features from which the nearest locations are found.</span>
<span class="sd">        measurement_type : Required string</span>
<span class="sd">            The nearest locations can be determined by measuring straight-line distance, driving distance, or driving time</span>
<span class="sd">        max_count : Optional int</span>
<span class="sd">            The maximum number of near locations to find for each feature in analysisLayer.</span>
<span class="sd">        search_cutoff : Optional float</span>
<span class="sd">            Limits the search range to this value</span>
<span class="sd">        search_cutoff_units : Optional string</span>
<span class="sd">            The units for the value specified as searchCutoff</span>
<span class="sd">        time_of_day : Optional datetime.date</span>
<span class="sd">            When measurementType is DrivingTime, this value specifies the time of day to be used for driving time calculations based on traffic.</span>
<span class="sd">        time_zone_for_time_of_day : Optional string</span>
<span class="sd">            </span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict with the following keys:</span>
<span class="sd">           &quot;nearest_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;connecting_lines_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;FindNearest&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;analysisLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">analysis_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;nearLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">near_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;measurementType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">measurement_type</span>
        <span class="k">if</span> <span class="n">max_count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;maxCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_count</span>
        <span class="k">if</span> <span class="n">search_cutoff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;searchCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">search_cutoff</span>
        <span class="k">if</span> <span class="n">search_cutoff_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;searchCutoffUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">search_cutoff_units</span>
        <span class="k">if</span> <span class="n">time_of_day</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;timeOfDay&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_of_day</span>
        <span class="k">if</span> <span class="n">time_zone_for_time_of_day</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;timeZoneForTimeOfDay&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_zone_for_time_of_day</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;nearestLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            
            <span class="n">nearest_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;nearestLayer&#39;</span><span class="p">])</span>

            <span class="n">connecting_lines_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;connectingLinesLayer&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;nearest_layer&quot;</span><span class="p">:</span><span class="n">nearest_layer</span><span class="p">,</span> <span class="s">&quot;connecting_lines_layer&quot;</span><span class="p">:</span><span class="n">connecting_lines_layer</span><span class="p">,</span> <span class="p">}</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.plan_routes"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.plan_routes">[docs]</a>    <span class="k">def</span> <span class="nf">plan_routes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">stops_layer</span><span class="p">,</span>
                       <span class="n">route_count</span><span class="p">,</span>
                       <span class="n">max_stops_per_route</span><span class="p">,</span>
                       <span class="n">route_start_time</span><span class="p">,</span>
                       <span class="n">start_layer</span><span class="p">,</span>
                       <span class="n">start_layer_route_id_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">return_to_start</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">end_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">end_layer_route_id_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">travel_mode</span><span class="o">=</span><span class="s">&quot;Driving&quot;</span><span class="p">,</span>
                       <span class="n">stop_service_time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">max_route_time</span><span class="o">=</span><span class="mi">525600</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        stops_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        route_count : Required int</span>
<span class="sd">            </span>
<span class="sd">        max_stops_per_route : Required int</span>
<span class="sd">            </span>
<span class="sd">        route_start_time : Required datetime.date</span>
<span class="sd">            </span>
<span class="sd">        start_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        start_layer_route_id_field : Optional string</span>
<span class="sd">            </span>
<span class="sd">        return_to_start : Optional bool</span>
<span class="sd">            </span>
<span class="sd">        end_layer : Optional layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        end_layer_route_id_field : Optional string</span>
<span class="sd">            </span>
<span class="sd">        travel_mode : Optional string</span>
<span class="sd">            </span>
<span class="sd">        stop_service_time : Optional float</span>
<span class="sd">            </span>
<span class="sd">        max_route_time : Optional float</span>
<span class="sd">            </span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            </span>
<span class="sd">        context : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict with the following keys:</span>
<span class="sd">           &quot;routes_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;assigned_stops_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;unassigned_stops_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;PlanRoutes&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;stopsLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">stops_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;routeCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">route_count</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;maxStopsPerRoute&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_stops_per_route</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;routeStartTime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">route_start_time</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;startLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">start_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_layer_route_id_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;startLayerRouteIDField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">start_layer_route_id_field</span>
        <span class="k">if</span> <span class="n">return_to_start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;returnToStart&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">return_to_start</span>
        <span class="k">if</span> <span class="n">end_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;endLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">end_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">end_layer_route_id_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;endLayerRouteIDField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">end_layer_route_id_field</span>
        <span class="k">if</span> <span class="n">travel_mode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;travelMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">travel_mode</span>
        <span class="k">if</span> <span class="n">stop_service_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;stopServiceTime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stop_service_time</span>
        <span class="k">if</span> <span class="n">max_route_time</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;maxRouteTime&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_route_time</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;routesLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            
            <span class="n">routes_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;routesLayer&#39;</span><span class="p">])</span>

            <span class="n">assigned_stops_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;assignedStopsLayer&#39;</span><span class="p">])</span>

            <span class="n">unassigned_stops_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;unassignedStopsLayer&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;routes_layer&quot;</span><span class="p">:</span><span class="n">routes_layer</span><span class="p">,</span> <span class="s">&quot;assigned_stops_layer&quot;</span><span class="p">:</span><span class="n">assigned_stops_layer</span><span class="p">,</span> <span class="s">&quot;unassigned_stops_layer&quot;</span><span class="p">:</span><span class="n">unassigned_stops_layer</span><span class="p">,</span> <span class="p">}</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.trace_downstream"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.trace_downstream">[docs]</a>    <span class="k">def</span> <span class="nf">trace_downstream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_layer</span><span class="p">,</span>
                       <span class="n">split_distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">split_units</span><span class="o">=</span><span class="s">&quot;Kilometers&quot;</span><span class="p">,</span>
                       <span class="n">max_distance</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">max_distance_units</span><span class="o">=</span><span class="s">&quot;Kilometers&quot;</span><span class="p">,</span>
                       <span class="n">bounding_polygon_layer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">source_database</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">generalize</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        split_distance : Optional float</span>
<span class="sd">            </span>
<span class="sd">        split_units : Optional string</span>
<span class="sd">            </span>
<span class="sd">        max_distance : Optional float</span>
<span class="sd">            </span>
<span class="sd">        max_distance_units : Optional string</span>
<span class="sd">            </span>
<span class="sd">        bounding_polygon_layer : Optional layer (see Feature Input in documentation)</span>
<span class="sd">            </span>
<span class="sd">        source_database : Optional string</span>
<span class="sd">            </span>
<span class="sd">        generalize : Optional bool</span>
<span class="sd">            </span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            </span>
<span class="sd">        context : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        trace_layer : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;TraceDownstream&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">input_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">split_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;splitDistance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_distance</span>
        <span class="k">if</span> <span class="n">split_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;splitUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">split_units</span>
        <span class="k">if</span> <span class="n">max_distance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;maxDistance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_distance</span>
        <span class="k">if</span> <span class="n">max_distance_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;maxDistanceUnits&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_distance_units</span>
        <span class="k">if</span> <span class="n">bounding_polygon_layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;boundingPolygonLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">bounding_polygon_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">source_database</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;sourceDatabase&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_database</span>
        <span class="k">if</span> <span class="n">generalize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;generalize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">generalize</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;traceLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;traceLayer&#39;</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="SpatialAnalysisTools.connect_origins_to_destinations"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.SpatialAnalysisTools.connect_origins_to_destinations">[docs]</a>    <span class="k">def</span> <span class="nf">connect_origins_to_destinations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">origins_layer</span><span class="p">,</span>
                       <span class="n">destinations_layer</span><span class="p">,</span>
                       <span class="n">measurement_type</span><span class="o">=</span><span class="s">&quot;DrivingTime&quot;</span><span class="p">,</span>
                       <span class="n">origins_layer_route_id_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">destinations_layer_route_id_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">time_of_day</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">time_zone_for_time_of_day</span><span class="o">=</span><span class="s">&quot;GeoLocal&quot;</span><span class="p">,</span>
                       <span class="n">output_name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates routes between pairs of points.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        origins_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The routes start from points in the origins layer.</span>
<span class="sd">        destinations_layer : Required layer (see Feature Input in documentation)</span>
<span class="sd">            The routes end at points in the destinations layer.</span>
<span class="sd">        measurement_type : Required string</span>
<span class="sd">            The routes can be determined by measuring travel distance or travel time along street network using different travel modes or by measuring straight line distance. </span>
<span class="sd">        origins_layer_route_id_field : Optional string</span>
<span class="sd">            The field in the origins layer containing the IDs that are used to match an origin with a destination.</span>
<span class="sd">        destinations_layer_route_id_field : Optional string</span>
<span class="sd">            The field in the destinations layer containing the IDs that are used to match an origin with a destination.</span>
<span class="sd">        time_of_day : Optional datetime.date</span>
<span class="sd">            When measurementType is DrivingTime, this value specifies the time of day to be used for driving time calculations based on traffic. WalkingTime and TruckingTime measurementType do not support calculations based on traffic.</span>
<span class="sd">        time_zone_for_time_of_day : Optional string</span>
<span class="sd">            Determines if the value specified for timeOfDay is specified in UTC or in a time zone that is local to the location of the origins.</span>
<span class="sd">        output_name : Optional string</span>
<span class="sd">            Additional properties such as output feature service name.</span>
<span class="sd">        context : Optional string</span>
<span class="sd">            Additional settings such as processing extent and output spatial reference.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict with the following keys:</span>
<span class="sd">           &quot;routes_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;unassigned_origins_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">           &quot;unassigned_destinations_layer&quot; : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;ConnectOriginsToDestinations&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;originsLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">origins_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;destinationsLayer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_feature_input</span><span class="p">(</span><span class="n">destinations_layer</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;measurementType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">measurement_type</span>
        <span class="k">if</span> <span class="n">origins_layer_route_id_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;originsLayerRouteIDField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">origins_layer_route_id_field</span>
        <span class="k">if</span> <span class="n">destinations_layer_route_id_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;destinationsLayerRouteIDField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">destinations_layer_route_id_field</span>
        <span class="k">if</span> <span class="n">time_of_day</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;timeOfDay&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_of_day</span>
        <span class="k">if</span> <span class="n">time_zone_for_time_of_day</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;timeZoneForTimeOfDay&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_zone_for_time_of_day</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;serviceProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="n">output_name</span> <span class="p">}}</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;routesLayer&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            
            <span class="n">routes_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;routesLayer&#39;</span><span class="p">])</span>

            <span class="n">unassigned_origins_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;unassignedOriginsLayer&#39;</span><span class="p">])</span>

            <span class="n">unassigned_destinations_layer</span> <span class="o">=</span> <span class="n">FeatureCollection</span><span class="p">(</span><span class="n">job_values</span><span class="p">[</span><span class="s">&#39;unassignedDestinationsLayer&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;routes_layer&quot;</span><span class="p">:</span><span class="n">routes_layer</span><span class="p">,</span> <span class="s">&quot;unassigned_origins_layer&quot;</span><span class="p">:</span><span class="n">unassigned_origins_layer</span><span class="p">,</span> <span class="s">&quot;unassigned_destinations_layer&quot;</span><span class="p">:</span><span class="n">unassigned_destinations_layer</span><span class="p">,</span> <span class="p">}</span>
</div></div>
<div class="viewcode-block" id="RasterAnalysisTools"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.RasterAnalysisTools">[docs]</a><span class="k">class</span> <span class="nc">RasterAnalysisTools</span><span class="p">(</span><span class="n">_AsyncService</span><span class="p">):</span>
    <span class="s">&quot;Represents the RasterAnalysisTools service. The RasterAnalysisTools service is used by ArcGIS Server to provide distributed raster analysis.&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">gis</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a client to the service given it&#39;s url from ArcGIS Online or Portal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">gis</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span> <span class="o">=</span> <span class="n">gis</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">&quot;f&quot;</span> <span class="p">:</span> <span class="s">&quot;json&quot;</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    


<div class="viewcode-block" id="RasterAnalysisTools.generate"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.RasterAnalysisTools.generate">[docs]</a>    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">raster_function</span><span class="p">,</span>
                       <span class="n">output_raster</span><span class="p">,</span>
                       <span class="n">raster_arguments</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">raster_properties</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">num_instances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        raster_function : Required, see http://resources.arcgis.com/en/help/rest/apiref/israsterfunctions.html</span>
<span class="sd">            </span>
<span class="sd">        output_raster : Required string (output service + item name), or preexisting portal item</span>
<span class="sd">            </span>
<span class="sd">        raster_arguments : Optional string, for specifying input Raster alone, portal Item can be passed</span>
<span class="sd">            </span>
<span class="sd">        raster_properties : Optional </span>
<span class="sd">            </span>
<span class="sd">        context : Optional </span>
<span class="sd">            </span>
<span class="sd">        num_instances : Optional </span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_raster : image layer item, if none, one is created, can also pass string (name of item+service)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">output_raster</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="s">&#39;GeneratedRasterProduct&#39;</span> <span class="o">+</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">_id_generator</span><span class="p">()</span>
            <span class="n">output_raster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span><span class="n">output_name</span><span class="p">,</span> <span class="s">&quot;Service created by Copy Raster tool&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_raster</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">matched</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">output_raster</span><span class="p">,</span> <span class="n">max_items</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">output_raster</span> <span class="o">==</span> <span class="n">item</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]:</span>
                            <span class="n">output_raster</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;itemId&#39;</span> <span class="p">:</span> <span class="n">item</span><span class="o">.</span><span class="n">itemid</span> <span class="p">}</span>
                            <span class="n">matched</span> <span class="o">=</span> <span class="bp">True</span>
                            <span class="k">break</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">matched</span><span class="p">:</span>
                    <span class="n">output_raster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span><span class="n">output_raster</span><span class="p">,</span> <span class="s">&quot;Service created by Copy Raster tool&quot;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">output_raster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span><span class="n">output_raster</span><span class="p">,</span> <span class="s">&quot;Service created by Copy Raster tool&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">raster_arguments</span><span class="p">,</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">raster_arguments</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;image service&#39;</span><span class="p">:</span>
                <span class="n">raster_arguments</span> <span class="o">=</span>  <span class="p">{</span> <span class="s">&quot;Raster&quot;</span><span class="p">:{</span><span class="s">&quot;itemId&quot;</span><span class="p">:</span> <span class="n">raster_arguments</span><span class="o">.</span><span class="n">itemid</span> <span class="p">}</span> <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;item type must be image service&quot;</span><span class="p">)</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;GenerateRaster&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;rasterFunction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raster_function</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputRaster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_raster_input</span><span class="p">(</span><span class="n">output_raster</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">raster_arguments</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;rasterArguments&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raster_arguments</span>
        <span class="k">if</span> <span class="n">raster_properties</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;rasterProperties&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raster_properties</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>
        <span class="k">if</span> <span class="n">num_instances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;numInstances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_instances</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">job_values</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_raster</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;outRaster&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="n">item</span><span class="o">.</span><span class="n">share</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;outRaster&#39;</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="RasterAnalysisTools.rasterize"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.RasterAnalysisTools.rasterize">[docs]</a>    <span class="k">def</span> <span class="nf">rasterize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_table</span><span class="p">,</span>
                       <span class="n">output_raster</span><span class="p">,</span>
                       <span class="n">raster_info</span><span class="p">,</span>
                       <span class="n">value_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">num_instances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_table : Required string</span>
<span class="sd">            </span>
<span class="sd">        output_raster : Required string</span>
<span class="sd">            </span>
<span class="sd">        raster_info : Required string</span>
<span class="sd">            </span>
<span class="sd">        value_field : Optional string</span>
<span class="sd">            </span>
<span class="sd">        context : Optional string</span>
<span class="sd">            </span>
<span class="sd">        num_instances : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_raster : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Rasterize&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputTable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_table</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputRaster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_raster</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;rasterInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raster_info</span>
        <span class="k">if</span> <span class="n">value_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;valueField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_field</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>
        <span class="k">if</span> <span class="n">num_instances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;numInstances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_instances</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;outRaster&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;outRaster&#39;</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="RasterAnalysisTools.interpolate"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.RasterAnalysisTools.interpolate">[docs]</a>    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_table</span><span class="p">,</span>
                       <span class="n">output_raster</span><span class="p">,</span>
                       <span class="n">raster_info</span><span class="p">,</span>
                       <span class="n">value_field</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">interpolation_method</span><span class="o">=</span><span class="s">&quot;Nearest&quot;</span><span class="p">,</span>
                       <span class="n">radius</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">num_instances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_table : Required string</span>
<span class="sd">            </span>
<span class="sd">        output_raster : Required string</span>
<span class="sd">            </span>
<span class="sd">        raster_info : Required string</span>
<span class="sd">            </span>
<span class="sd">        value_field : Optional string</span>
<span class="sd">            </span>
<span class="sd">        interpolation_method : Optional string</span>
<span class="sd">            </span>
<span class="sd">        radius : Optional float</span>
<span class="sd">            </span>
<span class="sd">        context : Optional string</span>
<span class="sd">            </span>
<span class="sd">        num_instances : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_raster : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;Interpolate&quot;</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputTable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_table</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputRaster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_raster</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;rasterInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raster_info</span>
        <span class="k">if</span> <span class="n">value_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;valueField&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_field</span>
        <span class="k">if</span> <span class="n">interpolation_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;interpolationMethod&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolation_method</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>
        <span class="k">if</span> <span class="n">num_instances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;numInstances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_instances</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="c">#print(job_values)</span>
        <span class="k">if</span> <span class="n">output_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;outRaster&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c"># Feature Collection</span>
            <span class="k">return</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;outRaster&#39;</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="RasterAnalysisTools.copy"><a class="viewcode-back" href="../../arcgis.tools.html#arcgis.tools.RasterAnalysisTools.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">input_raster</span><span class="p">,</span>
                       <span class="n">output_raster</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">output_cellsize</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">resampling_method</span><span class="o">=</span><span class="s">&quot;NEAREST&quot;</span><span class="p">,</span>
                       <span class="n">clipping_geometry</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">context</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                       <span class="n">num_instances</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_raster : Required string</span>
<span class="sd">            </span>
<span class="sd">        output_raster : Required string or image service item from portal. If string, specify name of the image service that will be created as output.</span>
<span class="sd">            </span>
<span class="sd">        output_cellsize : Optional dict, {&quot;x&quot;: &lt;numeric number&gt;, &quot;y&quot;: &lt;numeric number&gt;}</span>
<span class="sd">            </span>
<span class="sd">        resampling_method : Optional string, Values: Nearest | Bilinear | Cubic | Majority</span>
<span class="sd">            </span>
<span class="sd">        clipping_geometry : Optional dict, the JSON geometry object that is used to clip the input image. </span>
<span class="sd">                            The clipping geometry object may contain the shape description, extent and the clip type. </span>

<span class="sd">            </span>
<span class="sd">        context : Optional dict, eg { &quot;outSR&quot; : {spatial reference} }</span>
<span class="sd">            </span>
<span class="sd">        num_instances : Optional string</span>
<span class="sd">            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out_raster : layer (FeatureCollection)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">task</span> <span class="o">=</span><span class="s">&quot;CopyRaster&quot;</span>
        
        <span class="k">if</span> <span class="n">output_raster</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">output_name</span> <span class="o">=</span> <span class="n">input_raster</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span> <span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="s">&quot;_&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="s">&#39;Copy&#39;</span> <span class="o">+</span> <span class="s">&#39;_&#39;</span> <span class="o">+</span> <span class="n">_id_generator</span><span class="p">()</span>
            <span class="n">output_raster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span><span class="n">output_name</span><span class="p">,</span> <span class="s">&quot;Service created by Copy Raster tool&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output_raster</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="c">#check if there&#39;s an item by that name, if yes, use that</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">output_raster</span><span class="p">,</span> <span class="n">max_items</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">output_raster</span> <span class="o">==</span> <span class="n">item</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]:</span>
                        <span class="n">output_raster</span> <span class="o">=</span> <span class="p">{</span> <span class="s">&#39;itemid&#39;</span> <span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span> <span class="p">}</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">output_raster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span><span class="n">output_raster</span><span class="p">,</span> <span class="s">&quot;Service created by Copy Raster tool&quot;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">output_raster</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gis</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">create_service</span><span class="p">(</span><span class="n">output_raster</span><span class="p">,</span> <span class="s">&quot;Service created by Copy Raster tool&quot;</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span><span class="p">[</span><span class="s">&quot;inputRaster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_raster_input</span><span class="p">(</span><span class="n">input_raster</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputRaster&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_raster_input</span><span class="p">(</span><span class="n">output_raster</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_cellsize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;outputCellsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_cellsize</span>
        <span class="k">if</span> <span class="n">resampling_method</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;resamplingMethod&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resampling_method</span>
        <span class="k">if</span> <span class="n">clipping_geometry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;clippingGeometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">clipping_geometry</span>
        <span class="k">if</span> <span class="n">context</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;context&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span>
        <span class="k">if</span> <span class="n">num_instances</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s">&quot;numInstances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">num_instances</span>

        <span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="n">job_info</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_status</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        <span class="n">job_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_analysis_job_results</span><span class="p">(</span><span class="n">task_url</span><span class="p">,</span> <span class="n">job_info</span><span class="p">)</span>
        
        <span class="c">#print(job_values)</span>
        
        <span class="n">itemid</span> <span class="o">=</span> <span class="n">job_values</span><span class="p">[</span><span class="s">&#39;outRaster&#39;</span><span class="p">][</span><span class="s">&#39;itemId&#39;</span><span class="p">]</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">arcgis</span><span class="o">.</span><span class="n">gis</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_portal</span><span class="p">,</span> <span class="n">itemid</span><span class="p">)</span>
        <span class="n">item</span><span class="o">.</span><span class="n">share</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">item</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Esri.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>